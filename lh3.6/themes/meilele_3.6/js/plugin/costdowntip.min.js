(function(){var a=[];a.push("#JS_lightBox_costdown_box.COSTDOWNTIP .in {width:430px;height:auto;margin:0 auto;}");a.push(".COSTDOWNTIP .body{padding:15px;}");
a.push(".COSTDOWNTIP .body .notes{display:none;height:73px;margin-bottom:25px;overflow:hidden}");a.push(".COSTDOWNTIP .body .notes .txt{}");a.push(".COSTDOWNTIP .body .notes .txt dt{width:130px;height:36px;margin:0 auto;line-height:36px;padding-left:40px;background:url(http://image.meilele.com/images/201310/1381914613.png) 0 -76px no-repeat;font-size:14px;}");
a.push(".COSTDOWNTIP .body .notes .txt dd{height:48px;line-height:24px;margin-top:5px;color:#606060;}");a.push(".COSTDOWNTIP .body .inputMsg{}");a.push(".COSTDOWNTIP .body .inputMsg p.orange{height:26px;line-height:26px;background:#fff3ea; padding: 4px 0; margin:0;}");
a.push(".COSTDOWNTIP .body .inputMsg ul{padding:0 10px;margin-top:10px;}");a.push(".COSTDOWNTIP .body .inputMsg ul li{height:24px;padding:5px 0 5px 70px;}");
a.push(".COSTDOWNTIP .body .inputMsg label{display:inline-block;height:24px;line-height:24px;}");a.push(".COSTDOWNTIP .body .inputMsg .checkbox{margin:5px 5px 0 0;vertical-align:top;}");
a.push(".COSTDOWNTIP .body .inputMsg .input{width:170px;height:24px;line-height:24px;padding-left:3px;border:solid 1px #cfcfcf;color:#787878;}");a.push(".COSTDOWNTIP .body .inputMsg .cap_input{width:70px;height:24px;line-height:24px;padding-left:3px;border:solid 1px #cfcfcf;color:#787878;}");
a.push(".COSTDOWNTIP .body .inputMsg p{margin-top:20px;text-align:center;}");a.push(".COSTDOWNTIP .body .inputMsg .show_msg{margin-top:10px;background:url(http://image.meilele.com/images/201310/1381914613.png) 0 0 no-repeat; padding-left: 18px;}");
a.push(".COSTDOWNTIP .body .inputMsg .show_msg.error{background-position:0 0;margin-left: 140px;}");a.push(".COSTDOWNTIP .body .inputMsg .show_msg.warning{background-position:0 -23px;margin-left: 40px;}");
a.push(".COSTDOWNTIP .body .inputMsg .submit{display:inline-block;width:58px;height:31px;overflow:hidden;background:url(http://image.meilele.com/images/201310/1381914613.png) 0 -45px no-repeat;}");
a.push(".COSTDOWNTIP #JS_captcha {margin: 0 6px; background: url(http://image.meilele.com/themes/paipai/images/user/loading.gif) scroll no-repeat center center;cursor:pointer;}");
a.push(".COSTDOWNTIP .body .inputMsg ._check_icon{display:inline-block;height:16px;width:15px;margin-top:9px;vertical-align:top;}");a.push(".COSTDOWNTIP .body .inputMsg .sms_captcha_success{background:url("+$.__IMG+"/images/check_icon8.png) 0 -8px no-repeat}");
a.push(".COSTDOWNTIP .body .inputMsg .sms_captcha_error{background:url("+$.__IMG+"/images/check_icon8.png) 0 -30px no-repeat}");$.insertStyle(a.join(""));
})();var costDown={};$.costDownTip=function(a){costDown.goodsId=a;costDown.setUI();costDown.changeCaptcha($("#JS_captcha"));};costDown.setUI=function(){var c=[];
if(costDown.showed){return;}if($.cookie("meilele_login")==1){var b=$.cookie("ECS[mobile_phone]");var a=$.cookie("ECS[email]");}c.push('<div class="notes" id="JS_priceDown_notes">');
c.push('<dl class="txt">');c.push("<dt>降价通知订阅成功！</dt>");c.push("<dd>一旦商品降价，您将收到邮件或手机短信通知，第一时间获知价格变化。</dd>");c.push("</dl>");c.push("</div>");c.push('<div class="inputMsg" id="JS_costDown_inputMsg">');
c.push('<p class="orange">邮件和短信选填一个即可！如商品降价，您将收到邮件或短信通知。</p>');c.push("<ul>");c.push('<li>邮件通知：<input id="JS_priceDown_mail" type="email" type="text" class="input" value="'+(a?a:"请输入您的邮箱")+'" /></li>');
c.push('<li>短信通知：<input id="JS_priceDown_mobile" type="text" class="input" value="'+(b?b:"请输入您的手机号")+'" /></li>');c.push('<li>&emsp;验证码：<input id="JS_priceDown_catp" type="text" class="cap_input"/><img id="JS_captcha" src="http://image.meilele.com/themes/paipai/images/blank.gif" width="66" height="28" style="display:none" onclick="costDown.changeCaptcha($(\'#JS_captcha\'));costDown._reset_captcha();"><span class="_check_icon" id="_JS_sndSms_captcha_icon"></span></li>');
c.push("</ul>");c.push('<div id="JS_costDown_msg" class="red show_msg"></div>');c.push('<p id="JS_costDown_submit"><a class="submit" href="javascript:;" onclick="costDown.ajaxSend();" title="确定"></a></p>');
c.push("</div>");costDown.showed=true;costDown.showLightBox(c.join(""));$("#JS_priceDown_mail,#JS_priceDown_mobile").on("focus.cost",function(){var d=$(this).val();
if(d=="请输入您的邮箱"||d=="请输入您的手机号"){$(this).off("focus.cost").val("");}});$.checkCaptcha($("#JS_priceDown_catp"),{success:function(){var d=$("#_JS_sndSms_captcha_icon");
d.addClass("sms_captcha_success");d.removeClass("sms_captcha_error");costDown.captcha_flag=true;},error:function(){var d=$("#_JS_sndSms_captcha_icon");
d.removeClass("sms_captcha_success");d.addClass("sms_captcha_error");costDown.captcha_flag=false;}});};costDown.showLightBox=function(a,c){costDown.removeUI();
var b='<div class="lightBox COSTDOWNTIP MALERT '+(c||"")+'" id="JS_lightBox_costdown_box"><div class="in"><div class="htmls"><div class="clearfix title"><div class="Left"><i style="display:inline-block;"></i><span>降价通知</span></div><a href="javascript:;" class="Right" onclick="costDown.removeUI();return false;">&times;</a></div><div class="body">'+a+"</div></div>";
$.showMask(199);var d=$(b);d.css("zIndex",200);d.appendTo($("body"));d[0]._showMask=true;};costDown.removeUI=function(){$.closeLightBox("JS_lightBox_costdown_box");
costDown.showed=false;return false;};costDown.changeCaptcha=function(a){if(!a){return;}a.show();a.prev().val("").focus();$.getCaptcha(a);};costDown.showMsg=function(b,a){a=a||"error";
$("#JS_costDown_msg").removeClass(costDown.msgClass).addClass(a).html(b);costDown.msgClass=a;};costDown.ajaxSend=function(){var a=$.trim($("#JS_priceDown_mail").val()+""),c=$.trim($("#JS_priceDown_mobile").val()+""),b=$.trim($("#JS_priceDown_catp").val()+"");
if(!b||!costDown.captcha_flag){var e=$("#_JS_sndSms_captcha_icon");e.removeClass("sms_captcha_success");e.addClass("sms_captcha_error");$("#JS_costDown_msg").html("");
return false;}if((!a||a=="请输入您的邮箱")&&(!c||c=="请输入您的手机号")){costDown.showMsg("请至少填写一种接收方式！");return false;}if(a&&a!="请输入您的邮箱"){var d=/^(.)+@(.)+$/;if(!d.test(a)){costDown.showMsg("请输入正确的邮箱地址！");
return false;}}if(c&&c!="请输入您的手机号"){var d=/^\d{11}$/;if(!d.test(c)){costDown.showMsg("请输入正确的手机号码！");return false;}}costDown.showMsg("请稍候，正在提交。。。","warning");
$.ajax({url:"/ajax_goods/?act=onSaleNotice&new=1&goods_id="+costDown.goodsId+"&email="+a+"&tel="+c+"&captcha="+b,dataType:"json",cache:false,success:function(f){if(f.error){costDown.changeCaptcha($("#JS_captcha"));
var g="error";if(f.flag){g="warning";}costDown.showMsg(f.message,g);}else{$("#JS_costDown_inputMsg").hide();$("#JS_costDown_submit").hide();$("#JS_priceDown_notes").show();
}},error:function(){costDown.showMsg("发生错误");}});};costDown.captcha_flag=false;costDown._reset_captcha=function(){costDown.captcha_flag=false;$("#JS_costDown_msg").html("");
$("#_JS_sndSms_captcha_icon")[0].className="_check_icon";};$.costDown=costDown;
/*GH:2013-11-19 14:33:26*/