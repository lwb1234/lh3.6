(function(e, h) {
	var p = [["tiaopi.gif", "(tiaopi)", /\(tiaopi\)/gi], ["angry.gif", "(angry)", /\(angry\)/gi], ["blush.gif", ":-[", /:-\[/gi], ["confused.gif", "?:|", /\?:\|/gi], ["cool.gif", "B-)", /B-\)/gi], ["cry.gif", ":'(", /:'\(/gi], ["devil.gif", "]:)", /\]:\)/gi], ["grin.gif", ":-D", /:-D/gi], ["happy.gif", ":-)", /:-\)/gi], ["love.gif", ":x", /:x/gi], ["mischief.gif", ";\\", /;\\/gi], ["sad.gif", ":-(", /:-\(/gi], ["plain.gif", ":|", /:\|/gi], ["xinsui.gif", ":sx0", /:sx0/gi], ["silly.gif", ":-p", /:-p/gi], ["wink.gif", ";-)", /;-\)/gi], ["weiqu.gif", "(weiqu)", /\(weiqu\)/gi], ["touxiao.gif", "(touxiao)", /\(touxiao\)/gi], ["rose.gif", "(rose)", /\(rose\)/gi], ["woshou.gif", "(woshou)", /\(woshou\)/gi], ["qiang.gif", "(qiang)", /\(qiang\)/gi], ["ok.gif", ":)", /\:\)/gi], ["win.gif", "(win)", /\(win\)/gi], ["bye.gif", "(bye)", /\(bye\)/gi]];
	var j = ("http://image.meilele.com") + "/mchat/images/chat/emot2/";
	var g = G_obj && G_obj.listNum ? G_obj.listNum: window.screen.width >= 1280 ? 4 : 3,
	a = 12,
	n = Math.ceil(a / g),
	r = 0,
	c = "show_all";
	loadingData = false,
	minScrollNum = 0,
	$img_list = [],
	img_width = g == 3 ? 315 : 285,
	isShowTop = false,
	G_data = {},
	G_reply_pages = 0,
	thisPageNum = 0,
	pages = -1,
	G_blank_img = "http://image.meilele.com/images/blank.gif",
	G_default_headimg = "http://image.meilele.com/zximages/data/avatar/1356167666908299006.jpg",
	hasData = true;
	var f = function(s) {
		s.each(function() {
			var u = e(this),
			t = u.attr("data-src");
			if (t) {
				u.attr("src", t);
				u.removeAttr("data-src");
			}
		});
	};
	function d(t) {
		if (!t) {
			return "";
		}
		for (var s = 0; s < p.length; s++) {
			t = t.replace(p[s][2], '<img src="' + j + p[s][0] + '" />');
		}
		return t;
	}
	var m = function(w, s) {
		var v = "",
		u = 0,
		t = 0;
		for (; u < n; u++) {
			t = u * g + s;
			if (!w[t]) {
				continue;
			}
			v += '<div class="dome_box">';
			v += '<div class="img_box" style="width:' + img_width + 'px;">';
			v += '<a href="/xspace/show-' + w[t].tid + '.html" title="' + w[t].title + '" target="_blank">';
			v += '<img src="' + G_blank_img + '" data-src="' + (w[t].img || G_blank_img) + '" width="' + img_width + '"/>';
			v += "</a>";
			v += '<div class="img_num img_tips img_num_w img_tips_box">' + (w[t].img_count || 0) + "p</div>";
			v += '<div class="img_tips_t img_num_w img_tips_box">' + (w[t].img_count || 0) + "p</div>";
			if (c == "month") {
				if (w[t].prize_level == 0 || w[t].prize_level > 0 && w[t].prize_level <= 4) {
					v += '<div class="icon_sprite icon_prize_bend icon_prize_bend_' + w[t].prize_level + '"></div>';
				}
			}
			v += "</div>";
			v += '<div class="img_info_box">';
			v += '<div class="clearfix padding0_10">';
			v += '<div class="Left like_review_box"><a href="javascript:;" class="icon_sprite icon_like JS_i_like" data-tid="' + w[t].tid + '"></a>';
			v += '<i class="icon_sprite icon_like_only JS_only_like" style="display:none;"></i>';
			v += '</div><span class="like_num Left like_review_box JS_like_num">' + (w[t].love_count || 0) + "</span>";
			v += '<div class="Right like_review_box"><a href="javascript:;" data-pid="' + w[t].tid + '" class="review_link JS_review_link"><span>评论</span><span class="Arial ml5">' + w[t].reply + "</span></a></div>";
			v += "</div>";
			v += '<div class="clearfix mt10 padding0_10">';
			v += '<div class="Left"><a href="' + (w[t].zx_user_url || "javascript:;") + '"><img src="' + G_blank_img + '" data-src="' + (w[t].zx_user_small_avatar || G_default_headimg) + '" width="32" height="32"/></a></div>';
			v += '<div class="Right reply_message_box reply_message_box_" style="width:' + (img_width - 60) + 'px;">';
			v += '<a href="' + (w[t].zx_user_url || "javascript:;") + '" class="name">' + (w[t].poster_name || "匿名") + "：</a>";
			v += '<p class="content">' + d(w[t].content) + "</p>";
			v += "</div>";
			v += "</div>";
			if (w[t].reply_message) {
				v += '<div class="JS_reply_message_box padding0_10">';
				v += '<div class="clearfix">';
				v += '<div class="Left"><a href="' + (w[t].reply_message.zx_user_url || "javascript:;") + '"><img src="' + G_blank_img + '" data-src="' + (w[t].reply_message.zx_user_small_avatar || G_default_headimg) + '" width="32" height="32"/></a></div>';
				v += '<div class="Right reply_message_box reply_message_box_" style="width:' + (img_width - 60) + 'px;">';
				v += '<a href="' + (w[t].reply_message.zx_user_url || "javascript:;") + '" class="name">' + (w[t].reply_message.poster_name || "匿名") + "：</a>";
				v += '<span class="content">' + d(w[t].reply_message.content) + "</span>";
				v += '<a href="javascript:;" class="reply_link JS_reply_link" data-rid="' + (w[t].reply_message.tid || "0") + '" data-pid="' + (w[t].reply_message.parent_id || w[t].tid) + '">回复</a>';
				v += "</div>";
				v += "</div>";
				v += "</div>";
			}
			v += '<div class="reply_box JS_reply_box padding0_10" style="display:none;">';
			v += '<div class="edit_box"><i class="icon_sprite icon_triangle"></i><textarea maxlength="140" class="edit JS_edit_reply"></textarea><span class="JS_reply_someone reply_somone"></span></div>';
			v += '<div class="clearfix mt5">';
			v += '<div class="Left"><a href="javascript:;" class="JS_append_face append_smile_box clearfix"><i class="icon_sprite Left icon_smile"></i><span>插入表情</span></a></div>';
			v += '<div class="Right"><a href="javascript:;" class="JS_submit_reply submit_reply">回复</a><a href="javascript:;" class="JS_cancel_reply cancel_reply">取消</a></div>';
			v += "</div>";
			v += "</div>";
			v += "</div>";
			if (w[t].reply_message) {
				v += '<div style="height:10px;background:#F8F8F8; overflow:hidden"></div>';
			} else {
				v += '<div style="height:10px;background:#FFF; overflow:hidden"></div>';
			}
			v += '<div class="icon_sprite icon_shadow" style="display: block;"></div>';
			v += "</div>";
		}
		return v;
	};
	var o = function(u) {
		var t = "",
		s = 0;
		for (; s < g; s++) {
			t += '<div class="Left xspace_list_box" id="JS_xspace_list_' + s + '" style="width:' + img_width + "px;";
			t += s == 0 ? "margin-left:0px;": "";
			t += '">';
			t += m(u, s) + "</div>";
		}
		return t;
	};
	function i(x, v) {
		e.showMask();
		var u = e('<div id="JS_lightBox_captcha" class="lightBox" style="z-index:501;"><div style="width:200px;margin:0 auto;border:1px solid #dedede;border-radius:4px;"><div class="clearfix captcha_title" style="background:#f1f1f1;height:30px;border-bottom:1px solid #dedede;padding:10px 0 0 10px;"><h3 style="float:left;font-size:16px;font-weight:normal;font-family:\'Microsoft Yahei\',\'SimSong\';color:#333;">输入验证码</h3></div><div class="captcha_box" style="padding:20px;background:#fff;"></div></div></div>'),
		s = e('<input type="text" style="width:60px;height:28px;border:1px solid #c7c7c7;padding:0;margin:0;vertical-align:top;color:#555;padding-left:5px;margin-left:10px;line-height:28px;">'),
		t = e('<input type="button" value="提交" style="height:31px;background:#c00;border-radius:6px;width:81px;color:#fff;text-align:center;border:none;margin: 10px 28px 0;padding:0;font-weight:bold;">'),
		w = e('<a href="javascript:;" style="float:right;display:block;color:#909090;display:block;width:32px;text-align:center;font-weight:bold;font-size:18px;">&times;</a>');
		img = e("<img src=" + x + ' width="60" height="30" />'),
		box = u.find(".captcha_box"),
		closeCaptcha = function() {
			e.hideMask();
			e.closeLightBox("JS_lightBox_captcha");
		};
		t.click(function() {
			var y = e.trim(s.val());
			if (y.length == 4) {
				v();
				closeCaptcha();
			} else {
				alert("验证码不正确");
			}
		});
		w.click(function() {
			closeCaptcha();
		});
		u.find(".captcha_title").append(w);
		box.append(img);
		box.append(s);
		box.append(t);
		e("body").append(u);
	}
	function q(t) {
		t = t || null;
		if (t == null) {
			return;
		}
		var s = {};
		s[t] = "1";
		M.addToCart(t, s, null, {
			is_logistics: "1"
		});
	}
	var l = function() {
		this._init();
	};
	l.prototype = {
		constructor: l,
		_init: function() {

			var s = this,
			u = e("body");
			f(e("img"));
			this.month = "";
			s._likeEd();
			e("#JS_notice").hide();
			this._scrollTop = 0;
			var t = {};
			this._event();
			if (G_obj.pageName == "index") {
				t = {
					act: "ajax_load_xpsace",
					type: c,
					width: img_width,
					order: "add_time",
					page: r
				};
				if (c == "month" && s.month != "") {
					t.month = s.month;
					t.act = "load_prize_article";
				} else {
					t.type = c;
					t.act = "ajax_load_xpsace";
				}
				this._ajaxDataHander(t);
				minScrollNum = 450;
				$img_list = e("#JS_xspace_main");
				this._scrollTop = $img_list.position().top;
				s._pageTime(t);
			}
			if (G_obj.pageName == "detail") {
				img_width = "315";
				$img_list = e("#JS_more_xspace_box");
				s._getReply(G_obj.tid, 1);
				s._detailEvent();
				setTimeout(function() {
					var w = e("#JS_detail_box").height() - 40,
					v = e("#JS_detail_left").height();
					if (w > v) {
						e("#JS_detail_left").height(w);
					}
				},
				1500);
				e.slide(e("#JS_focus_nav a"), e("#JS_focus_stage"), {
					eventType: "mouseover",
					autoRun: 5000,
					step: 267,
					onSlide: function(x) {
						var v = e('#JS_focus_stage img:eq("' + x.index + '")'),
						w = v.attr("lazy-src");
						if (w) {
							v.attr("src", w);
							v.removeAttr("lazy-src");
						}
					}
				});
				c = "show_hot";
				setTimeout(function() {
					minScrollNum = e(document).height();
					k({
						$box: e("#JS_reply_page"),
						pages: G_reply_pages,
						callback: function(v) {
							s._getReply(G_obj.tid, v);
						}
					});
				},
				500);
				t = {
					act: "ajax_load_xpsace",
					page: r,
					type: "show_hot",
					order: "love_count",
					width: "315"
				};
				s._listContentEvent($img_list);
			}
			if (G_obj.pageName == "list") {
				setTimeout(function() {
					minScrollNum = e(document).height() - e("#JS_xspace_activity").position().top;
				},
				500);
				img_width = 315;
				$img_list = e("#JS_xspace_main");
				c = "show_goods";
				t = {
					act: "ajax_load_xpsace",
					width: img_width,
					order: "add_time",
					page: r,
					goods_sn: G_obj.goods_sn,
					type: c
				};
				this._ajaxDataHander(t);
				setTimeout(function() {
					e.post("/ajax_ajax.html", {
						act: "ajax_load_xpsace",
						type: "show_all",
						width: 315,
						order: "add_time",
						page: 0,
						limit: 12
					},
					function(v) {
						e("#JS_meby_you_like").html(o(v));
						f(e("#JS_meby_you_like img"));
						s._listContentEvent(e("#JS_meby_you_like"));
					},
					"json");
				},
				2000);
			}
			G_data = t;
			e(window).scroll(function() {
				if (!hasData) {
					return;
				}
				var x = 0,
				v, w;
				x = e(document).height();
				v = e(document).scrollTop();
				w = e(window).height();
				if (v + w + minScrollNum > x && !loadingData) {
					if (thisPageNum > 3) {
						if (G_obj.pageName == "index") {
							e("#JS_index_page").show();
						}
						return false;
					}
					t = G_data;
					if (G_obj.pageName == "detail") {
						t.limit = 12;
						hasData = false;
					}
					t.page = r;
					s._ajaxDataHander(t);
				}
			});
		},
		_likeEd: function() {
			var s = e.cookie("like_ed"),
			t = s || "";
			e(".JS_i_like").each(function() {
				var u = e(this),
				v = u.attr("data-tid");
				if (t.indexOf(v) > 0) {
					u.hide();
					u.siblings(".JS_only_like").show();
				}
			});
		},
		_detailEvent: function() {
			var s = this;
			e("#reply_thread_textarea_tips").click(function() {
				var t = e("#reply_thread_textarea").val();
				if (t == "") {
					e(this).hide();
					e("#reply_thread_textarea").focus().css({
						height: "32px"
					});
					e("#reply_thread_opt").show();
				}
			});
			e("#reply_thread_textarea").focus(function() {
				var t = e(this),
				u = t.val();
				if (u == "") {
					e("#reply_thread_textarea_tips").hide();
					t.css({
						height: "32px"
					});
					e("#reply_thread_opt").show();
				}
			});
			e("#JS_detail_left").on("click", ".JS_append_face",
			function(t) {
				t.stopPropagation();
				s._faceClickHander(e(this));
			}).on("click", ".detail_submit_reply",
			function() {
				var x = e(this),
				v = x.parents(".JS_reply_box").find("#reply_thread_textarea").val(),
				u = G_obj.tid,
				w = x.attr("data-rid");
				if (v.length > 140) {
					alert("最多只能输入140个字符");
					return;
				}
				var t = function() {
					e.post("/ajax_ajax.html", {
						act: "post_reply",
						content: v,
						parent_id: u,
						reply_id: w
					},
					function(y) {
						if (y.error != 0) {
							if (y.captcha) {
								i(y.captcha, t);
								return;
							}
							if (y.data == "need_login") {
								e.showLoginBox(function() {
									t();
								});
								return;
							} else {
								alert(y.message);
								return;
							}
						}
						s._getReply(u, 1);
						if (w == 0) {
							e("#reply_thread_textarea_tips").show();
							e("#reply_thread_textarea").css({
								height: "16px"
							}).val("");
							e("#reply_thread_opt").hide();
						}
					},
					"json");
				};
				t();
			}).on("click", ".reply_this",
			function() {
				var x = e(this),
				u = x.parents(".first_c").attr("data-id"),
				w = G_obj.tid,
				v = x.parent().parent();
				var t = "";
				t += '<div class="reply_thread_box mt10 JS_reply_box" id="JS_reply_box_id">';
				t += '<textarea class="reply_textarea JS_edit_reply" maxlength="140" id="reply_thread_textarea" rows="1" style="height: 16px;"></textarea>';
				t += '<p id="reply_thread_opt" class="clearfix mt5" style="display: block;">';
				t += '<a href="javascript:;" class="JS_append_face Left append_smile_box clearfix">';
				t += '<i class="icon_sprite Left icon_smile"></i>';
				t += '<span class="Left ml2">插入表情</span>';
				t += "</a>";
				t += '<a href="javascript:;" class="Right detail_submit_reply" data-rid="' + u + '">发表</a>';
				t += "</p></div>";
				if (e("#JS_reply_box_id").length > 0) {
					e("#JS_reply_box_id").remove();
				}
				v.append(t);
			}).on("click", ".JS_i_like",
			function() {
				s._likeHander(e(this));
			});
		},
		_ajaxDataHander: function(u) {
			var s = this,
			t = {
				width: img_width,
				order: "add_time",
				page: r
			};
			if (c == "month" && s.month == "") {
				return;
			}
			u.limit = 12;
			e("#loadingPage").show();
			loadingData = true;
			var t = u;
			if (t.page == 0) {
				t.get_num = true;
			} else {
				delete t.get_num;
			}
			e.post("/ajax_ajax.html", t,
			function(y) {
				if (t.limit && y.length < t.limit) {
					hasData = false;
				}
				if (y.length == 0) {
					e("#loadingPage").hide();
					hasData = false;
					if (thisPageNum == 0) {
						var x = "";
						if (c == "my_post") {
							x = '<div class="page_tips_no_content">你还没有作品</div>';
						}
						if (c == "month_now") {
							x = '<div class="page_tips_no_content">本月还没有人发布秀家，赶快抢沙发吧...</div>';
						}
						$img_list.html(x);
					}
					return;
				}
				if (c == "my_post") {
					if (y.error == 1) {
						e.showLoginBox(function() {
							e('#JS_banner_nav a[data-type="my_post"]').click();
						});
					} else {
						if (y[0] && y[0].examine_data && e("#JS_notice").length <= 0 && !e.cookie("close_notice")) {
							var w = '<div class="w mt10" id="JS_notice"><span class="xspace-notice"><i class="icon-notice"></i>提示：您有秀家作品没有通过审核，如需帮助，请联系小编(QQ:2874951361)。<a class="icon-close-notice"></a></span></div>';
							e("#JS_xspace_main").before(w);
							e("#JS_notice").on("click", "a",
							function() {
								e("#JS_notice").remove();
								e.cookie("close_notice", "true");
							});
						}
					}
				}
				if (t.page == 0) {
					if (y[0].all_num) {
						pages = Math.ceil((Number(y[0].all_num) + 1) / 4);
					} else {
						pages = 0;
					}
				}
				if (thisPageNum == 0 && (G_obj && G_obj.pageName != "list")) {
					$img_list.html(o(y));
				} else {
					for (var v = 0; v < g; v++) {
						e("#JS_xspace_list_" + v).append(m(y, v));
					}
				}
				f($img_list.find("img"));
				r++;
				thisPageNum++;
				loadingData = false;
				e("#loadingPage").hide();
				s._likeEd();
			},
			"json").fail(function() {
				
			});
		},
		_pageTime: function(u) {
			var w = e(document),
			t = this,
			v = 100;
			var s = function() {
				if (pages == "-1") {
					v += 100;
					setTimeout(s, v);
				} else {
					e("#JS_index_page").off("click", "a[data-num]");
					e("#JS_index_page").off("click", ".JS_prev");
					e("#JS_index_page").off("click", ".JS_next");
					k({
						$box: e("#JS_index_page"),
						pages: pages,
						callback: function(x) {
							hasData = true;
							w.scrollTop(t._scrollTop);
							r = 4 * x - 4;
							thisPageNum = 0;
							if (G_obj.pageName == "index") {
								var y = e("#JS_banner_nav a.active").attr("data-type");
								if (y == "month" && t.month != "") {
									u.month = t.month;
									u.act = "load_prize_article";
								} else {
									u.type = y;
									u.act = "ajax_load_xpsace";
								}
							}
							u.page = r;
							t._ajaxDataHander(u);
						}
					});
				}
			};
			setTimeout(s, v);
		},
		_event: function() {
			var s = this,
			t = e("body");
			e("body").click(function() {
				e("#JS_face_box").remove();
			});
			e("#JS_notice").on("click", "a",
			function() {
				e.cookie("close_notice", "true");
				e("#JS_notice").remove();
			});
			e("#JS_time_fianl").on("click", "a",
			function() {
				var v = e(this);
				r = 0;
				thisPageNum = 0;
				pages = -1;
				s.month = v.attr("data-val");
				var u = {
					act: "load_prize_article",
					width: img_width,
					order: "add_time",
					page: r,
					month: s.month
				};
				hasData = true;
				v.siblings().removeClass("active_t");
				v.addClass("active_t");
				G_data = u;
				s._ajaxDataHander(u);
				s._pageTime(u);
			});
			e("#JS_host_classify").on("click", "a",
			function() {
				var w = e(this);
				w.addClass("active").siblings(".active").removeClass("active");
				r = 0;
				thisPageNum = 0;
				pages = -1;
				c = "show_tag";
				var u = w.attr("data-cat"),
				v = {
					act: "ajax_load_xpsace",
					type: c,
					cat: u,
					order: "add_time",
					width: img_width,
					page: r
				};
				G_data = v;
				s._ajaxDataHander(v);
				s._pageTime(v);
			});
			e("#JS_banner_nav").on("click", "a",
			function() {
				e("#JS_index_page").hide();
				var v = e(this),
				u = v.attr("data-type");
				e("#JS_host_classify a").removeClass("active");
				c = u;
				r = 0;
				thisPageNum = 0;
				pages = -1;
				data = {
					act: "ajax_load_xpsace",
					type: c,
					width: img_width,
					order: "add_time",
					page: r
				};
				hasData = true;
				if (c == "month_now") {
					isShowTop = true;
					data.order = "love_count";
				} else {
					isShowTop = false;
				}
				if (c == "my_post") {
					e("#JS_notice").show();
				} else {
					e("#JS_notice").hide();
				}
				e("#JS_host_classify, #JS_time_fianl").hide();
				v.siblings("a").removeClass("active");
				v.addClass("active");
				if (c == "month") {
					e("#JS_time_fianl").show();
					e("#JS_host_classify").hide();
					e("#JS_time_fianl a:eq(0)").click();
					return;
				}
				if (c == "show_all") {
					e("#JS_time_fianl").hide();
					e("#JS_host_classify").show();
				}
				if (c == "my_post") {
					if (! (e.cookie("meilele_login") == "1" && e.cookie("ECS[username]"))) {
						e.showLoginBox(function() {
							e('#JS_banner_nav a[data-type="my_post"]').click();
						});
						return false;
					}
					data.act = "show_my_article";
				}
				G_data = data;
				s._ajaxDataHander(data);
				s._pageTime(data);
			});
			s._listContentEvent(e("#JS_xspace_main"));
		},
		_listContentEvent: function(t) {
			var s = this;
			t.on("click", ".JS_i_like",
			function() {
				s._likeHander(e(this));
			}).on("focus", ".JS_edit_reply",
			function() {
				var u = e(this);
				if (u.val() == "") {
					u.siblings(".JS_reply_someone").hide();
				}
			}).on("blur", ".JS_edit_reply",
			function() {
				var u = e(this);
				if (u.val() == "") {
					u.siblings(".JS_reply_someone").show();
				}
			}).on("click", ".JS_append_face",
			function(u) {
				u.stopPropagation();
				s._faceClickHander(e(this));
			}).on("click", ".JS_cancel_reply",
			function() {
				e(this).parents(".JS_reply_box").slideUp(100);
			}).on("click", ".JS_reply_link",
			function() {
				var w = e(this),
				x = w.parents(".JS_reply_message_box").siblings(".JS_reply_box"),
				v = w.siblings(".name").text(),
				u = x.find(".JS_edit_reply").val();
				v = v.slice(0, -1);
				if (u == "") {
					x.find(".JS_reply_someone").text("回复@" + v);
				}
				x.toggle(50);
				x.find(".JS_submit_reply").data({
					rid: w.attr("data-rid"),
					pid: w.attr("data-pid")
				});
			}).on("click", ".JS_review_link",
			function() {
				var u = e(this),
				v = u.parent().parent().siblings(".JS_reply_box");
				v.find(".JS_reply_someone").text("");
				v.toggle(50);
				v.find(".JS_submit_reply").data({
					pid: u.attr("data-pid"),
					rid: "0"
				});
			}).on("click", ".JS_submit_reply",
			function() {
				var w = e(this),
				v = w.data(),
				u = w.parents(".JS_reply_box").find(".JS_edit_reply").val();
				s._sendReply({
					content: u,
					rid: v.rid,
					pid: v.pid
				},
				w);
			});
		},
		_likeHander: function(u) {
			var t = u.parent().siblings(".JS_like_num"),
			s = Number(t.text()),
			v = u.attr("data-tid"),
			w = e.cookie("like_ed") || "";
			e.post("/ajax_ajax.html", {
				act: "ajax_love",
				tid: v,
				type: "love"
			},
			function(x) {
				if (x.error != "0") {
					alert(x.message);
					return;
				}
				e.cookie("like_ed", w + "," + v);
				u.hide();
				u.siblings(".JS_only_like").show();
				t.text(s + 1);
			},
			"json").fail(function() {
				
			});
		},
		_faceClickHander: function(y) {
			var v = "",
			t = e("#JS_face_box"),
			x = y.parents(".JS_reply_box"),
			w = x.find(".JS_reply_someone"),
			z = x.find(".JS_edit_reply");
			t.remove();
			v += '<div class="face_box" id="JS_face_box">';
			for (var s = 0; s < p.length; s++) {
				var u = p[s][0];
				if (u) {
					v += '<a href="javascript:void(0);" emot-id="' + s + '"><img src="' + j + u + '" /></a>';
				}
			}
			v += "</div>";
			y.parents(".JS_reply_box").append(v);
			e("#JS_face_box").on("click", "a",
			function() {
				var A = e(this).attr("emot-id");
				z.val(z.val() + p[A][1]);
				e("#JS_face_box").remove();
				w.hide();
			});
		},
		_getReply: function(u, t) {
			if (!u) {
				return;
			}
			var s = this;
			e.post("/ajax_ajax.html", {
				act: "get_reply",
				tid: u,
				type: "get_is_own",
				page: t
			},
			function(v) {
				if (v.error != 0) {
					return;
				}
				e("#reply_list").html(v.html);
				e("#reply_count").html("(" + v.reply_num + ")");
				e("#JS_already_love").html(v.love_count);
				if (v.is_own != 1) {
					e("#JS_edit").remove();
				}
				G_reply_pages = v.page_count;
				e(".JS_reply_content_dwt").each(function() {
					var w = e(this),
					x = w.html();
					w.html(d(x));
				});
			},
			"json").fail(function() {
				
			});
		},
		_sendReply: function(u, t) {
			var s = this;
			if (u.content.length > 140) {
				alert("最多只能输入140个字符");
				return;
			}
			e.post("/ajax_ajax.html", {
				act: "post_reply",
				content: u.content,
				parent_id: u.pid,
				reply_id: u.rid
			},
			function(w) {
				if (w.error != "0") {
					if (w.captcha) {
						i(w.captcha,
						function() {
							s._sendReply(u, t);
						});
						return;
					}
					if (w.data == "need_login") {
						e.showLoginBox(function() {
							s._sendReply(u, t);
						});
					} else {
						alert(w.message);
					}
					return;
				}
				var v = "",
				y = t.parents(".JS_reply_box");
				v += '<div class="JS_reply_message_box padding0_10">';
				v += '<div class="clearfix">';
				v += '<div class="Left"><a href="' + w.user.zx_user_url + '"><img src="' + w.user.zx_user_small_avatar + '" width="32" height="32"/></a></div>';
				v += '<div class="Right reply_message_box reply_message_box_" style="width:' + (img_width - 60) + 'px;">';
				v += '<a href="' + w.user.zx_user_url + '" class="name">' + (e.cookie("ECS[username]")) + "：</a>";
				v += '<span class="content">' + d(u.content) + "</span>";
				v += '<a href="javascript:;" class="reply_link JS_reply_link" data-rid="' + w.tid + '" data-pid="' + u.pid + '">回复</a>';
				v += "</div>";
				v += "</div>";
				v += "</div>";
				if (y.prev(".JS_reply_message_box").length > 0) {
					y.prev(".JS_reply_message_box").remove();
				}
				y.before(v).hide().find(".JS_edit_reply").val("");
				var x = y.parents(".img_info_box").find(".JS_review_link").children("span:last");
				x.text(Number(x.text()) + 1);
			},
			"json").fail(function() {
				
			});
		}
	};
	var b = function(u, t, s, v) {
		this.index = 0;
		this.$list = u.children("a");
		this.$prev = t;
		this.$next = s;
		this.$count = v;
		this.num = this.$list.length;
		this._init();
	};
	b.prototype = {
		constructor: b,
		_init: function() {
			this._event();
		},
		_event: function() {
			var s = this;
			s.$next.click(function() {
				s._setIndex();
				var u = s.$list.eq(s.index),
				t = u.children("img"),
				v = t.attr("lazy-src");
				if (v) {
					t.attr("src", v);
					t.removeAttr("lazy-src");
				}
			});
			s.$prev.click(function() {
				s._setIndex(true);
			});
		},
		_setIndex: function(t) {
			var s = this;
			if (t) {
				s.index -= 1;
			} else {
				s.index += 1;
			}
			if (s.index >= s.num) {
				s.index = 0;
			}
			if (s.index < 0) {
				s.index = s.num - 1;
			}
			s.$count.text(s.index + 1);
			s.$list.hide();
			s.$list.eq(s.index).show();
		}
	};
	var k = function(s) {
		return new k.prototype._init(s);
	};
	k.prototype = {
		constructor: k,
		_init: function(s) {
			this.page = s.page || 1;
			this.pages = s.pages || 1;
			this.callback = typeof(s.callback) ? s.callback: new Function;
			this.$box = s.$box || "";
			this._initNum = this.pages > 7 ? 5 : this.pages;
			if (this.pages == 1) {
				this.$box.html("").hide();
				return;
			}
			this.$box.html(this._getHtml(1, this._initNum));
			this.$box.children(".JS_page_box").children("a:eq(0)").addClass("active");
			this._event();
		},
		_getHtml: function(u, s) {
			var t = "";
			if (this.page != 1) {
				t += '<a href="javascript:;" class="JS_prev icon_sprite Left icon_prev"></a>';
			}
			t += '<div class="JS_page_box Left page_box">';
			if (this.page > 3 && this.pages > 7) {
				t += '<a href="javascript:;" data-num="1">1</a>';
				t += "<span>...</span>";
			}
			for (; u <= s; u++) {
				t += '<a href="javascript:;" data-num="' + u + '">' + u + "</a>";
			}
			if (this.page < this.pages - 3 && this.pages > 7) {
				t += "<span>...</span>";
				t += '<a href="javascript:;" data-num="' + this.pages + '">' + this.pages + "</a>";
			}
			t += "</div>";
			if (this.page != this.pages) {
				t += '<a href="javascript:;" class="JS_next icon_sprite Left icon_next"></a>';
			}
			return t;
		},
		_event: function() {
			var s = this;
			s.$box.on("click", ".JS_prev",
			function() {
				if (s.page == 1) {
					return;
				}
				s.page -= 1;
				s._hander(s.page);
			}).on("click", ".JS_next",
			function() {
				if (s.page == s.pages) {
					return;
				}
				s.page += 1;
				s._hander(s.page);
			}).on("click", "a[data-num]",
			function() {
				var u = e(this),
				t = Number(u.attr("data-num"));
				s.page = t;
				s._hander(t);
			});
		},
		_hander: function(v) {
			var s = this,
			u = 0,
			t = 0;
			if (v > 3 && v < s.pages - 3) {
				if (s.pages <= 7) {
					u = 1;
					t = s._initNum;
				} else {
					u = v - 1;
					t = v + 1;
				}
			}
			if (v <= 3) {
				if (s.pages <= 7) {
					u = 1;
					t = s._initNum;
				} else {
					u = 1;
					t = 5;
				}
			}
			if (v >= s.pages - 3) {
				if (s.pages <= 7) {
					u = 1;
					t = s.pages;
				} else {
					u = s.pages - 5;
					t = s.pages;
				}
			}
			s.$box.html(s._getHtml(u, t));
			var w = s.$box.children(".JS_page_box");
			w.children("a").removeClass("active");
			w.children('a[data-num="' + s.page + '"]').addClass("active");
			s.callback(s.page);
		}
	};
	k.prototype._init.prototype = k.prototype;
	e(function() {
		new l();
		new b(e("#JS_slider"), e("#JS_prev_img"), e("#JS_next_img"), e("#JS_now_count"));
	});
})(jQuery);
/*LDZ:2013-10-18 16:17:11*/
