var IMG_HOST = $.__IMG + "/" || "http://image.meilele.com/";
var mchat = mchat || {};
var GD = GD || {};
var winDialog = window.winDialog;
GD.transNoExprText = "未设体验馆或该区域暂无数据，请选择方式B：自提货、自安装！";
GD.municipalitiesId = [2, 3, 10, 23];
GD.pageTitleChangeTime = GD.pageTitleChangeTime || 1356710400;
GD.cityList = GD.cityList || {};
GD.districtList = GD.districtList || {};
GD.copyCityList = GD.copyCityList || {};
var GL = GL || {};
var GP = GP || {};
var exprListKeyCityId = exprListKeyCityId || {};
var specailArea = [];
var Good = function(a) {
	if (this instanceof Good) {
		this.attr = a;
		this.id = a.goods_id;
		if (a.price_type && (a.price_type.ship_type == 2 || a.price_type.is_logistics == 1)) {
			this.transType = 1;
			if (a.price_type.is_logistics == 1) {
				this.logistics = 1;
			}
		}
		this.page_title = a.page_title || "";
		this.number = 1;
		this.collected = this.copyGoodsShow = 0;
		this.addHandle();
		this.inSpecailArea = false;
		this.gotExprInfo = {};
		this.exprShowData = {};
		this.exprTmData = {};
		this.goodsPriceTransfer();
		var c = $("#JS_join_list .JS_join_list_item_" + this.id);
		if (c.length) {
			var b = {};
			$.each(c,
			function(d) {
				var e = c.eq(d);
				b[e.data("goods_id")] = {
					name: e.data("goods_name"),
					url: e.attr("href")
				};
			});
			GD.joinList = b;
		}
	} else {
		return new Good(a);
	}
};
Good.prototype = {
	constructor: Good,
	addHandle: function() {
		
		this.buyButton = $("#JS_main_goods_buy_" + this.id);
		this.tipsEvent();
		this.changeNumberEvent();
		this.buyEvent();
		this.bookPriceDownEvent();
		this.addressEvent();
		var b = this.id;
		var g = this;
		var d = $("#JS_main_goods_collect_" + this.id);
		if (d.length) {
			d.click(function() {
				GL[b].collect();
				return false;
			});
			d = null;
		}
		var c = $("#JS_main_goods_anzhuang_" + this.id);
		if (c.length) {
			c.click(GF.showTransPriceBox);
			c = null;
		}
		var h = $("#JS_comment_scroll_" + this.id);
		if (h.length) {
			h.click(function() {
				if (window.location.hash == "#JS_Tab_nav_pingjia") {
					window.location.hash = "";
				}
				window.location.hash = "JS_Tab_nav_pingjia";
				var l = $("#JS_Tab_nav_pingjia");
				if (l.length) {
					l[0]._type = "评价";
					l.click();
				}
				return false;
			});
			h = null;
		}
		var i = $("#JS_boughts_notes_" + this.id);
		if (i.length) {
			i.click(function() {
				if (window.location.hash == "#JS_Tab_nav_jilu") {
					window.location.hash = "";
				}
				window.location.hash = "JS_Tab_nav_jilu";
				$("#JS_Tab_nav_jilu").click();
				return false;
			});
			i = null;
		}
		var e = $("#JS_goods_chat_" + this.id);
		if (e.length) {
			e.click(function() {
				if (window.mchat) {
					window.mchat.openui("", {
						click: "goods_" + b
					});
					return false;
				}
			});
			e = null;
		}
		var a = $("#JS_send_sms");
		if (a.length) {
			var f = this;
			a.click(GF.sendSmsExprAddress);
		}
		$("#JS_transfer_province_" + this.id).click(function(n) {
			n = n || window.event;
			var m = n.target || n.srcElement;
			if (m && m.nodeType == 1 && m.nodeName == "A") {
				var l = $(m);
				var o = l.text(),
				p = l.data("region_id");
				g.selectProvince(p, o);
			}
			return false;
		});
		$("#JS_transfer_city_" + this.id).click(function(n) {
			n = n || window.event;
			var m = n.target || n.srcElement;
			if (m && m.nodeType == 1 && m.nodeName == "A") {
				var l = $(m);
				var o = l.text(),
				p = l.data("region_id");
				g.selectCity(p, o);
			}
			return false;
		});
		$("#JS_transfer_district_" + this.id).click(function(n) {
			n = n || window.event;
			var m = n.target || n.srcElement;
			if (m && m.nodeType == 1 && m.nodeName == "A") {
				var l = $(m);
				var o = l.text(),
				p = l.data("region_id");
				g.selectDistrict(p, o);
			}
			return false;
		});
		var k = $(".area_box");
		var j = $(".province_name");
		k.click(function() {
			var l = k.index(this);
			k.removeClass("current").eq(l).addClass("current");
			j.addClass("none").eq(l).removeClass("none");
		});
	},
	setTransType: function(i, b) {
		this.transType = i;
		var d = $("#JS_panel_trans_type_" + this.id + "_" + i);
		d.addClass("current");
		var c = $("#JS_panel_trans_type_" + this.id + "_" + (i == "1" ? "0": "1"));
		c.removeClass("current");
		var k = $("#JS_panel_kuaidi_tip_" + this.id);
		var a = $("#JS_express_type_" + this.id);
		var f = $("#JS_ptkuaidi_text_" + this.id);
		if (k && a) {
			if (i == "1") {
				if (this.logistics && this.attr.shop_id <= 1) {
					k.show();
				}
				a.removeClass("none");
				$("#JS_express_nav_" + this.id).removeClass("none");
			} else {
				k.hide();
				a.removeClass("none");
			}
		}
		var g = $("#JS_main_goods_anzhuang_" + this.id);
		var e = $("#JS_view_trans_price_info");
		var h = $("#JS_float_anzhuang_1");
		if (this.transType == "1") {
			g.hide();
			e.hide();
			h.hide();
			if (this.logistics == "1" && !this.inSpecailArea) {
				if (this.attr.shop_id <= 1) {
					k.show();
				}
				f.addClass("none");
			}
			GF.hideTransPriceBox();
		} else {
			if (this.attr.is_fitment == "1" || (this.attr.goods_attribute && this.attr.goods_attribute != 0) || this.attr.is_haier == 1) {
				g.hide();
				e.hide();
				h.hide();
			} else {
				if (this.attr.shop_id <= 1) {
					k.hide();
				}
				g.css({
					display: "inline-block"
				});
				e.css({
					display: "inline-block"
				});
				h.show();
				f.removeClass("none");
			}
		}
		var j = $("#JS_panel_trans_type_" + this.id);
		if (this.attr.price_type.is_logistics == "2") {
			j.show();
		}
		if (!b) {
			GF.getTransPrice();
		}
	},
	addressEvent: function() {
		var a = $("#JS_peisong_text_address_" + this.id);
		if (a.length) {
			a[0]._goods_id = this.id;
			a.mouseenter(function() {
				var b = GL[this._goods_id];
				b.hideAddress();
				b.showAdressBox();
			}).mouseleave(function() {
				var b = GL[this._goods_id];
				b.hideAddress();
			});
			a = null;
		}
	},
	bookPriceDownEvent: function() {
		var a = $("#JS_main_goods_bpd_" + this.id);
		if (a.length) {
			a[0]._goods_id = this.id;
			a.click(function() {
				if (_gaq) {
					_gaq.push(["_trackEvent", "goodsEvent", "bookPriceDown", this._goods_id]);
				}
				var b = GL[this._goods_id];
				b.bookPriceDown();
				return false;
			});
			a = null;
		}
	},
	bookPriceDown: function() {
		$.costDownTip(GD.currentJoinGoods.id, this.id);
	},
	buyEvent: function() {
		var a = this.buyButton;
		if (a.length) {
			a[0]._goods_id = this.id;
			a.click(function() {
				var f = $(this);
				var d = GL[this._goods_id];
				if (f.hasClass("disabled")) {
					$.alert("该地区暂不支持配送，请重新选择其他地区。");
					return false;
				}
				if (f.hasClass("tuangou") && d.copyGoodsShow != 1) {
					return true;
				}
				if (_gaq) {
					_gaq.push(["_trackEvent", "goodsEvent", "Buy", this._goods_id]);
				}
				if (d.copyGoodsShow == 1) {
					if (f.hasClass("now_buy_disabled")) {
						return false;
					}
					var e = "/install_buy.html";
					if (!$.cookie("ECS[username]") || $.cookie("meilele_login") != 1) {
						$.showLoginBox(function() {
							d.virtualBuy(e);
						});
					} else {
						d.virtualBuy(e);
					}
				} else {
					if (d.attr.goods_attribute == 5) {
						var e = "/custom-made/";
						if (!$.cookie("ECS[username]") || $.cookie("meilele_login") != 1) {
							$.showLoginBox(function() {
								d.virtualBuy(e);
							});
						} else {
							d.virtualBuy(e);
						}
					} else {
						d.buy();
					}
				}
				return false;
			});
			a = null;
		} else {
			var b = $("#JS_virtual_goods_buy_" + this.id);
			if (b.length) {
				b[0]._goods_id = this.id;
				b.click(function() {
					if (_gaq) {
						_gaq.push(["_trackEvent", "goodsEvent", "Buy", this._goods_id]);
					}
					var e = GL[this._goods_id];
					var f = "/virtualbuy/";
					var d = {
						action: "buy"
					};
					if (!$.cookie("ECS[username]") || $.cookie("meilele_login") != 1) {
						$.showLoginBox(function() {
							e.virtualBuy(f, d);
						});
					} else {
						e.virtualBuy(f, d);
					}
					return false;
				});
				b = null;
			}
		}
		var c = $("#JS_quickly_buy");
		c.data("_goods_id", this.id);
		c.on("click",
		function() {
			var e = c.data("_goods_id");
			var d = GL[e];
			if (window._gaq) {
				window._gaq.push(["_trackEvent", "goodsEvent", "Buy_navs", e]);
			}
			d.buy();
			return false;
		});
	},
	buy: function() {
		var a = {};
		a[this.id] = this.number;
		$.addToCart(GD.firstMainGoods.id, a, null, {
			is_logistics: this.transType || ""
		});
	},
	virtualBuy: function(e, c) {
		if (!e) {
			return;
		}
		var f = $("#JS_goods_number_" + this.id);
		var b = f.val() || 1;
		var d = {
			act: "pre_checkout",
			id: this.id,
			number: b
		};
		var a = document.createElement("form");
		$.extend(d, c || {});
		a.method = "post";
		a.target = "_self";
		a.action = e;
		GF.createInput(a, d);
		document.body.appendChild(a);
		a.submit();
	},
	tipsEvent: function() {
		var b = this.id;
		var c = $(".tip_i", "#JS_panel_tips_nav_" + b);
		var a = $("dl", "#JS_panel_tips_body_" + b);
		if (!c || !a) {
			return;
		}
		c.mouseenter(function() {
			var d = c.index(this);
			a.eq(d).show();
		}).mouseleave(function() {
			var d = c.index(this);
			a.eq(d).hide();
		});
		a.mouseenter(function() {
			var d = a.index(this);
			a.eq(d).show();
		}).mouseleave(function() {
			var d = a.index(this);
			a.eq(d).hide();
		});
		return false;
	},
	changeNumberEvent: function() {
		var b = $("#JS_goods_number_" + this.id);
		if (b.length) {
			this.dataMax = b[0].dataMax = b.attr("data-max");
			b[0]._id = this.id;
			b.change(function() {
				this.value = GF.formatNumber(this.value, this.dataMax);
				GL[this._id].setNumber(this.value);
			});
		}
		var d = $("#JS_goods_number_add_" + this.id);
		if (d.length) {
			d[0]._id = this.id;
			d.click(function() {
				GL[this._id].setNumber(GL[this._id].number - 0 + 1);
				
			});
		}
		var a = $("#JS_goods_number_del_" + this.id);
		if (a.length) {
			a[0]._id = this.id;
			a.click(function() {
				GL[this._id].setNumber(GL[this._id].number - 1);
				
			});
		}
		var c = $("#JS_goods_unit_number_" + this.id);
		if (c.length) {
			c[0]._id = this.id;
			c.change(function() {
				var f = this.value,
				e = Math.ceil(f / GL[this._id].attr.change_unit_ratio);
				GL[this._id].setNumber(e);
			});
		}
	},
	setNumber: function(c) {
		c = GF.formatNumber(c, this.dataMax);
		this.number = c;
		var a = $("#JS_goods_number_" + this.id),
		b = $("#JS_goods_unit_number_" + this.id);
		a.val(c);
		b.val((c * this.attr.change_unit_ratio).toFixed(2));
		changePrice();
	},
	refreshTransCount: function() {
		var a = $("#JS_goods_trans_count_" + this.id);
		if (!a.length || !(a.html() - 0)) {
			return;
		}
		if (!this.attr.transCount) {
			this.attr.transCount = a.html() - 0;
		}
		a.html((this.attr.transCount * this.number).toFixed(3));
		if (this.transType == "1") {
			this.countPressFee();
		}
	},
	viewImg: function(a) {
		if (typeof a == "object") {
			a = undefined;
		}
		_gaq.push(["_trackEvent", "goodsImg", this.id + "", '"' + (a || -1) + '"']);
		var b = "/gallery/" + this.id + (a === undefined ? "": "#" + a);
		window.open(b, "", "width=1024, height=678, top=0,left=0, toolbar=no, menubar=no, scrollbars=yes, resizable=yes,location=no, status=no");
	},
	goodsPriceTransfer: function() {
		if (this.attr.price_type.groupbuygoods == 1) {
			this.show_price = this.attr.price_type.group_price;
			this.priceType = "团购价";
		} else {
			this.show_price = this.attr.price_type.show_price;
			this.priceType = this.attr.price_type.type;
		}
	},
	setJoinGoodsCurrent: function(i, g) {
		if (!this.id) {
			return;
		}
		if (this.copyGoodsShow == 1) {
			var d = $("#JS_join_goods_nav_" + this.id + "_copy_" + this.id),
			b = $("#JS_join_goods_nav_" + this.id + "_" + this.id);
			b.addClass("current");
			d.removeClass("current");
			d = b = null;
			var h = this.buyButton;
			h.removeClass("now_buy now_buy_disabled");
			h = null;
			this.copyGoodsShow = 0;
			var f = $("#JS_panel_row_price_" + this.id);
			f.removeClass("none");
			f = null;
			var e = $("#JS_copy_goods_tip_" + this.id);
			e.addClass("none");
			e = null;
			var c = $("#JS_panel_show_price_" + this.id),
			a = $("#JS_panel_price_type_" + this.id);
			if (c.length && a.length) {
				c.html("&yen;" + GF.formatPrice(this.show_price));
				a.html(this.priceType + "：");
			}
			this.clearCopyGoodsCityStyle();
		}
		if (GD.currentJoinGoods == this && !i && this.copyGoodsShow != 1) {
			return;
		}
		GF.setCookie(this.id);
		this.setTransType(this.transType, true);
		GD.currentJoinGoods = this;
		g && this.exprRelativeGoodsChange();
	},
	setCurrentGoodsActiveTime: function() {
		var d = $("#JS_panel_activity_" + this.id);
		if (d.length) {
			var b = "",
			c = "",
			f = $("#JS_panel_time_" + this.id),
			e = $("#JS_panel_active_type_" + this.id),
			a = this.attr.price_type.activity_end_date;
			if (a && GD.unixTime && a - GD.unixTime > 0 && !(this.attr.is_fitment == 1 || this.attr.goods_attribute == 1)) {
				c = "剩余时间：" + GF.formatTime(a - GD.unixTime);
			}
			if (this.attr.activity_type == "促销") {
				b = (c ? "限时": "") + "促销";
			}
			if (this.attr.price_type.type == "特价") {
				b = "特价促销";
			}
			if (this.attr.activity_type == "包物流") {
				b = (c ? "限时": "") + "包物流";
			}
			if (this.attr.activity_type == "包快递") {
				b = "免快递费";
			}
			if (this.attr.discount_type == 2 && this.attr.reduce_price - 0) {
				b = '<span class="fx12">直降：已优惠' + parseInt(this.attr.reduce_price - 0) + "元</span>";
			} else {
				if (this.attr.price_type.discount_price - 0 && this.attr.discount_type == 1) {
					b = '<span class="fx12">下单即送' + parseInt(this.attr.price_type.discount_price - 0) + "元</span>";
				}
			}
			if (b) {
				if (c && this.attr.discount_type != 2) {
					f.html(c).show();
				} else {
					f.hide();
				}
				if (b) {
					e.html(b);
					d.show();
				} else {
					d.hide();
				}
			}
		}
		d = null;
	},
	setCopyGoodsCurrent: function(a) {
		if (this.copyGoodsShow == 1) {
			return;
		}
		if (!a && (!cityInstallFeeList || !cityInstallFeeList[GD.districtId])) {
			return;
		}
		this.copyGoodsShow = 1;
		var b = $("#JS_join_goods_nav_" + this.id + "_copy_" + this.id),
		f = $("#JS_join_goods_nav_" + this.id + "_" + this.id);
		b.addClass("current");
		f.removeClass("current");
		b = f = null;
		var d = $("#JS_panel_row_price_" + this.id);
		d.addClass("none");
		d = null;
		this.copyPriceChange();
		var c = this.buyButton;
		c.addClass((cityInstallFeeList && cityInstallFeeList[GD.districtId]) ? "now_buy": "now_buy now_buy_disabled");
		c = null;
		this.setCopyGoodsCityStyle();
		var e = $("#JS_copy_goods_tip_" + this.id);
		e.removeClass("none");
		e = null;
	},
	copyGoodschange: function(b) {
		var a = $("#JS_join_goods_nav_" + this.id + "_copy_" + this.id),
		b = b || GD.districtId;
		if (this.copyGoodsShow == 1) {
			this.copyPriceChange(b);
		}
		if (a.length) {
			if (cityInstallFeeList && cityInstallFeeList[b]) {
				a.removeClass("free_install");
				this.buyButton.removeClass("now_buy_disabled");
			} else {
				a.addClass("free_install");
				if (this.copyGoodsShow == 1) {
					this.buyButton.addClass("now_buy_disabled");
					return false;
				}
			}
		}
		a = null;
		return true;
	},
	copyPriceChange: function(f) {
		f = f || GD.districtId;
		if (!cityInstallFeeList || !cityInstallFeeList[f]) {
			return;
		}
		var c = $("#JS_panel_show_price_" + this.id),
		b = $("#JS_panel_price_type_" + this.id),
		a = $("#JS_panel_unit_price_" + this.id);
		if (c.length && b.length) {
			var e = Number(this.show_price) + Number(cityInstallFeeList[f]);
			c.html("&yen;" + GF.formatPrice(e));
			b.html("包安装价：");
			if (a.length) {
				var d = Math.ceil(e / this.attr.change_unit_ratio);
				a.html("&yen;" + GF.formatPrice(d));
			}
		}
		c = b = a = null;
	},
	setCopyGoodsCityStyle: function() {
		if (!cityInstallFeeList) {
			return;
		}
		var a = $("#JS_transfer_district_" + this.id + " a");
		a.each(function(b) {
			var c = a.eq(b);
			var d = c.data("region_id");
			if (cityInstallFeeList && !cityInstallFeeList[d]) {
				c.css("color", "#787878");
			}
		});
	},
	clearCopyGoodsCityStyle: function() {
		if (!cityInstallFeeList) {
			return;
		}
		var a = $("#JS_transfer_district_" + this.id + " a");
		a.css("color", "");
	},
	getExprRelativeGoods: function(a) {
		var b = this,
		d = GD.selectCityId || $.cookie("region_id") || 0,
		c = "&goods_id=" + this.id + "&city_id=" + d + "&district_id=" + GD.districtId + "&province_id=" + this.provinceId;
		a = a || false;
		if (a) {
			c += "&only_once=1";
		}
		$.ajax({
			url: "/ajax_goods/?act=expr_relative_goods_list" + c,
			dataType: "json",
			success: function(f) {
				if (f) {
					if (f.show) {
						b.exprShowData[d] = f.show;
					}
					if (f.temai) {
						b.exprTmData[d] = f.temai;
					}
					b.exprGoodsChange();
					if (f.collect) {
						b.collected = 1;
						var g = $("#JS_collect_2");
						var e = $("#JS_main_goods_collect_" + b.id);
						g.addClass("collected");
						e.addClass("collected");
						g = e = null;
					}
					if (f.expr_list && f.expr_list.length > 0) {
						GF.parseExprData(f.expr_list, f.jump_text_topic);
					}
					if (f.gift_info && f.gift_info.length > 0) {
						b.showGiftInfo(f.gift_info);
					}
					if (f.if_could_send == 0) {
						b.couldSend = false;
						b.buyButton.addClass("disabled");
						b.showStockInfo("no_goods");
					} else {
						b.couldSend = true;
						b.buyButton.removeClass("disabled");
						b.checkProvinceStock();
					}
					if (b.transType == "1") {
						b.countPressFee();
					}
				}
			},
			error: function() {
				b.exprGoodsChange();
			}
		});
	},
	exprRelativeGoodsChange: function(a) {
		var b = GD.selectCityId || $.cookie("region_id");
		if (!b) {
			return;
		}
		this.getExprRelativeGoods(a);
	},
	showGiftInfo: function(f) {
		var c = "",
		b = 0,
		d = f.length,
		a, e = $("#JS_panel_gift_" + this.id);
		for (; b < d; b++) {
			a = f[b];
			c += (b == 0 ? '<span class="">赠&emsp;品</span>：': "<br/>&emsp;&emsp;&emsp;&emsp;") + '<a href="' + a.goods_url + '" class="orange bold" target="_blank" title="' + a.goods_name + '">' + a.goods_name + "</a>";
		}
		e.html(c).show();
	},
	exprGoodsChange: function(j) {
		var a = $("#JS_expr_goods_" + this.id),
		r = GD.selectCityId || $.cookie("region_id");
		if (!a.length && !r) {
			return false;
		}
		var y = "",
		z = [];
		var b = $("#JS_expr_goods_list_" + this.id);
		if (this.exprShowData && this.exprShowData[r]) {
			if (exprListKeyCityId && exprListKeyCityId[r]) {
				var w = exprListKeyCityId[r],
				x = this.exprShowData[r];
				for (var q in x) {
					var k = x[q].expr_id,
					f = "/" + w.pinyin + "/goods.html?act=goods&region_id=" + r + "&eid=" + k,
					o = w.list[k];
					if (!o) {
						continue;
					}
					z.push('<a href="' + f + '" target="_blank" title="查看' + o.expr_name + '展品" class="expr_name_show">' + o.expr_name + "</a>");
				}
			}
			y += '<dl><dt class="bold">展品：</dt><dd>该商品正在' + z.join("、") + "展示！</dd></dl>";
		}
		if (this.exprTmData && this.exprTmData[r]) {
			if (exprListKeyCityId && exprListKeyCityId[r]) {
				var v = exprListKeyCityId[r],
				h = this.exprTmData[r];
				for (var l in h) {
					var m = [],
					s = h[l].sub_goods;
					if (s) {
						var p = s.length;
						for (var q = 0; q < p; q++) {
							m.push('<a href="' + s[q].url + '" title="查看' + s[q].goods_name + '详情" target="_blank" class="red">' + s[q].goods_name + "</a>");
						}
					}
					var c = "/" + v.pinyin + "/temai_" + h[l].expr_id + ".html";
					y += '<dl><dt class="bold">特卖：</dt><dd>该商品正在<a href="' + c + '" target="_blank" title="查看' + v.list[h[l].expr_id].expr_name + '特卖" class="expr_name_show">' + v.list[h[l].expr_id].expr_name + "</a>" + (s ? "与" + m.join("、") + "搭配": "") + '特卖！<span class="red">特卖价：<span class="yen bold">&yen;' + h[l].goods_price + '</span></span>&nbsp;仅剩<span class="red bold">' + h[l].goods_number + "</span>" + (s ? "套": "件") + "</dd></dl>";
				}
			}
		}
		if (b.length && y) {
			b.html(y);
			a.removeClass("none");
		} else {
			a.addClass("none");
		}
	},
	changeGoodsDetail: function() {
		GF.exprTipTab(this.id);
	},
	collect: function() {
		var a = this.id;
		if (_gaq) {
			_gaq.push(["_trackEvent", "goodsEvent", "collect", a]);
		}
		if (this.collected == 1) {
			this.collectDel();
		} else {
			this.collectAdd();
		}
	},
	collectDialog: function(b, c) {
		c = c || false;
		if (b && b.error == 0) {
			var a = [];
			a.push('<div class="collect_box"><div class="collect_h r"><a href="javascript:void(0);" onclick="$.closeLightBox();return false;" class="close">&times;</a></div>');
			a.push('<div class="collect_c c">');
			a.push('<h3 class="collect_tip"><span class="success_icon"></span><span id="JS_collect_msg" class="success_msg">' + (c ? "已经取消收藏": "收藏成功") + "</span></h3>");
			a.push('<p class="colloct_link">您已收藏<span class="red bold">' + (b.number || 0) + '</span>个商品，<a href="/user/?act=collection_list" class="red" target="_blank" title="查看收藏夹">查看收藏夹&gt;&gt;</a></p>');
			a.push("</div></div>");
			var d = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
			$.lightBox(a.join(""), {},
			true, 500, "position:absolute;top:" + (d + 300) + "px;", true);
		} else {
			$.alert(b.message || "操作失败");
		}
	},
	collectAdd: function() {
		var a = this.id;
		$.ajax({
			url: "/ajax_user/?act=collect&id=" + a,
			dataType: "json",
			cache: false,
			success: function(b) {
				if (b.error == 2) {
					$.cookie("meilele_login", "0");
					$.showLoginBox(function() {
						GL[a].collect();
					});
				} else {
					GL[a].collected = 1;
					var d = $("#JS_collect_2"),
					c = $("#JS_main_goods_collect_" + a);
					d.addClass("collected");
					c.addClass("collected");
					d = c = null;
					if (b.error == 0) {
						GL[a].collectDialog(b);
					} else {
						$.alert(b.message);
					}
				}
			},
			error: function() {
				$.alert("由于网络原因，收藏失败，请稍后再试。");
			}
		});
	},
	collectDel: function() {
		var a = this.id;
		$.ajax({
			url: "/ajax_user/?act=collect&action=del_collect&id=" + a,
			dataType: "json",
			cache: false,
			success: function(b) {
				GL[a].collected = 0;
				var d = $("#JS_collect_2");
				var c = $("#JS_main_goods_collect_" + a);
				d.removeClass("collected");
				c.removeClass("collected");
				d = c = null;
				GL[a].collectDialog(b, true);
			},
			error: function() {
				$.alert("由于网络原因，收藏失败，请稍后再试。");
			}
		});
	},
	showAdressBox: function() {
		var a = $("#JS_peisong_address_" + this.id);
		a.removeClass("none");
		a = null;
	},
	hideAddress: function() {
		this.hideProvBox();
		var a = $("#JS_peisong_address_" + this.id);
		a.addClass("none");
		a = null;
	},
	selectProvince: function(h, g, f) {
		var c = $("#JS_province_text_" + this.id),
		b = $("#JS_transfer_province_" + this.id);
		if (c.length && b.length) {
			this.hideProvBox();
			GD.provinceName = g;
			c.html(g);
			this.provinceId = h;
			if (inArray(specailArea, h)) {
				this.inSpecailArea = true;
			} else {
				this.inSpecailArea = false;
			}
			$(".area_box").addClass("none").eq(0).removeClass("none");
			if (!f) {
				if (h == 2) {
					this.selectCity(35, "北京");
					return;
				} else {
					if (h == 10) {
						this.selectCity(110, "上海");
						return;
					} else {
						if (h == 3) {
							this.selectCity(36, "天津");
							return;
						} else {
							if (h == 23) {
								this.selectCity(271, "重庆");
								return;
							}
						}
					}
				}
			}
			c.addClass("current");
			if (!GD.cityList[h]) {
				var a = this;
				GD.getAreaAjax && GD.getAreaAjax.abort();
				GD.getAreaAjax = $.ajax({
					url: '/ajax_ajax/?act=data_center&module=common&method=getRegionByParentId&param={"parent_id":' + h + "}",
					dataType: "json",
					cache: false,
					success: function(i) {
						if (i && i.error == 0 && i.region_list && i.region_list.length) {
							GD.cityList[h] = i.region_list;
							a.fillCity(h);
							if (f) {
								a.selectCity(GD.selectCityId, GD.selectCityName, true);
							}
						}
					},
					error: function() {}
				});
			} else {
				var d = $("#JS_transfer_city_" + this.id + "_" + h).find("a");
				if (!d || d.length == 0) {
					this.fillCity(h);
				}
			}
			var e = $("#JS_anzhuang_text_sheng");
			e.html(g);
			e = null;
		}
		c = cityDom = null;
		return;
	},
	fillCity: function(g) {
		var d = GD.cityList[g],
		f = $("#JS_transfer_city_" + this.id);
		if (!f.length) {
			return;
		}
		var b = this,
		e = "";
		f.empty();
		for (var c = 0,
		a = d.length; c < a; c++) {
			e += '<a id="JS_city_list_' + this.id + "_" + d[c].region_id + '" data-region_id="' + d[c].region_id + '">' + jQuery.trim(d[c].region_name) + "</a>";
		}
		$(".province_name").addClass("none");
		$(".area_box").removeClass("current").eq(1).addClass("current");
		f.html(e).removeClass("none");
		$("#JS_city_text_" + this.id).text("请选择").parent().removeClass("none");
	},
	fillDistrict: function(f) {
		var c = GD.districtList[f],
		e = $("#JS_transfer_district_" + this.id);
		if (!e.length) {
			return;
		}
		var d = "";
		e.empty();
		for (var b = 0,
		a = c.length; b < a; b++) {
			d += '<a data-region_id="' + c[b].region_id + '">' + jQuery.trim(c[b].region_name) + "</a>";
		}
		$(".province_name").addClass("none");
		$(".area_box").removeClass("current").eq(2).addClass("current");
		e.html(d).removeClass("none");
		$("#JS_district_text_" + this.id).text("请选择").parent().removeClass("none");
		if (this.copyGoodsShow == 1) {
			this.setCopyGoodsCityStyle();
		}
	},
	hideProvBox: function() {
		var c = inArray(GD.municipalitiesId, this.provinceId) ? 0 : this.provinceId;
		var a = $("#JS_transfer_prov_" + this.id + "_" + c),
		b = $("#JS_transfer_city_" + this.id + "_" + c);
		a.removeClass("current");
		b.addClass("none");
		a = b = null;
	},
	selectCity: function(e, d, c) {
		GD.selectCityId = e;
		GD.selectCityName = d;
		$("#JS_city_text_" + this.id).html(d);
		var b = $("#JS_anzhuang_text_shi");
		b.html(d);
		b = null;
		if (!GD.districtList[e]) {
			var a = this;
			GD.getAreaAjax && GD.getAreaAjax.abort();
			GD.getAreaAjax = $.ajax({
				url: '/ajax_ajax/?act=data_center&module=common&method=getRegionByParentId&param={"parent_id":' + e + "}",
				dataType: "json",
				cache: false,
				success: function(f) {
					if (f && f.error == 0 && f.region_list) {
						if (f.region_list.length) {
							GD.districtList[e] = f.region_list;
							a.fillDistrict(e);
							if (c) {
								var g = f.region_list[0];
								a.selectDistrict(g.region_id, g.region_name, c);
								a.attr.goods_attribute == 6 && a.setCopyGoodsCurrent(true);
							}
							$("#JS_district_area_box").removeClass("none");
						} else {
							$("#JS_district_area_box").addClass("none");
							a.selectDistrict();
						}
					}
				},
				error: function() {}
			});
		} else {
			this.fillDistrict(e);
		}
		return;
	},
	selectDistrict: function(e, d, c) {
		e = e || 0;
		d = d || "";
		GD.districtId = e;
		GD.districtName = d;
		d && $("#JS_district_text_" + this.id).html(d);
		this.hideAddress();
		this.exprRelativeGoodsChange(c);
		var b = "";
		b = (GD.provinceName == GD.selectCityName ? GD.provinceName: (GD.provinceName + GD.selectCityName)) + d;
		var a = $("#JS_peisong_address_nav_" + this.id);
		a.html(b);
		this.copyGoodschange(e);
	},
	countPressFee: function() {
		if (this.transType == 1) {
			var c = $("#JS_ptkuaidi_text_" + this.id),
			f = $("#JS_goods_trans_count_" + this.id),
			b = this.provinceId || GD.local.pid;
			if (!this.couldSend) {
				c.addClass("none");
			} else {
				if (typeof(deliver_info) == "object" && this.logistics != "1") {
					var e = deliver_info[b];
					if (!e) {
						c.addClass("none");
						return;
					} else {
						c.removeClass("none");
					}
					var g = Math.ceil(parseFloat(f.html())) - parseFloat(e.lifting);
					if (g < 0) {
						g = 0;
					}
					var d = (parseFloat(e.lifting_price) + g * parseFloat(e.add_heavy_price));
					c.html('快递费：<span class="red bold">' + d.toFixed(2) + "</span>");
				} else {
					if (this.logistics == "1" && this.inSpecailArea) {
						var a = 6;
						if (typeof(free_add_unit_fee) == "number") {
							a = free_add_unit_fee;
						}
						var d = Math.ceil(parseFloat(f.html())) * a;
						c.removeClass("none");
						c.html('快递费：<span class="red bold">' + d.toFixed(2) + "</span>");
					} else {
						c.addClass("none");
					}
				}
			}
			c = f = null;
		}
	},
	checkProvinceStock: function(b) {
		b = b || GD.selectCityId;
		if (!b) {
			return;
		}
		if (b && this.attr.shop_id > 1) {
			this.showStockInfo(1);
			return;
		}
		var a = this.stock_info;
		if (a && a.g) {
			if (this.id != a.g) {
				return;
			}
			if (inArray(a.nc, b)) {
				this.showStockInfo(1);
			} else {
				if (inArray(a.dc, b)) {
					this.showStockInfo(2);
				} else {
					this.showStockInfo(3);
				}
			}
		} else {
			if (a == "no data") {
				this.showStockInfo(3);
			} else {
				this.showStockInfo(0);
			}
		}
	},
	showStockInfo: function(b) {
		var a = $("#JS_stock_info_" + this.id);
		if (a.length) {
			switch (b) {
			case 1:
				a.css("background", "#ff0500");
				a.html("现货");
				break;
			case 2:
				a.css("background", "#ff7a00");
				a.html("调配");
				break;
			case 3:
				if (this.attr.shop_id <= 1) {
					a.css("background", "#82a54b");
					a.html("预定");
				}
				break;
			case 4:
				a.css("background", "#82a54b");
				a.html("无货");
				break;
			case "no_goods":
				a.css({
					background:
					"#fff",
					color: "#c00"
				});
				a.html("该地区暂不支持配送");
				break;
			default:
				a.css("background", "#ffffff");
				a.html("");
				break;
			}
			$("#JS_stock_div_" + this.id).removeClass("none");
		}
		a = null;
	}
};
var Peitao = function(a) {
	this.attr = a;
	this.id = a.goods_id;
	this.checkbox = $("#JS_peitao_goods_checkbox_" + this.id);
	this.numberInput = $("#JS_peitao_goods_number_" + this.id);
	this.addHandle();
};
Peitao.prototype = {
	constructor: Peitao,
	addHandle: function() {
		if (this.checkbox.length) {
			this.checkbox[0]._goods_id = this.id;
			this.checkbox.click(function() {
				var a = GP[this._goods_id];
				if (!a) {
					return;
				}
				if (this.checked) {
					a.onSelected();
				} else {
					a.onUnSelected();
				}
				GF.getTransPrice();
			});
		}
		if (this.numberInput.length) {
			this.numberInput[0]._goods_id = this.id;
			this.numberInput.change(function() {
				var c = GP[this._goods_id],
				b = c.numberInput.attr("data-max"),
				a = b || 9999;
				number = parseInt(c.numberInput.val());
				if (number > a) {
					number = a;
				}
				if (number < 0) {
					number = 0;
				}
				if (number) {
					c.onSelected();
				} else {
					c.onUnSelected();
				}
				c.numberInput.val(number || "0");
				c.number = number;
				GF.getTransPrice();
			});
		}
	},
	onSelected: function() {
		if (!this.numberInput.val()) {
			this.numberInput.val("1");
			this.number = 1;
		}
		this.selected = true;
		this.checkbox.attr("checked", true);
	},
	onUnSelected: function() {
		if (this.numberInput.val()) {
			this.numberInput.val("");
			this.number = 0;
		}
		this.selected = false;
		this.checkbox.attr("checked", false);
	}
};
var GF = {
	changeDomAttr: function(a, c) {
		if (!a) {
			return;
		}
		for (var b in c) {
			if (b == "innerHTML" || b == "html") {
				a.innerHTML = c[b];
			} else {
				if (b == "style") {
					a.style.cssText = c[b];
				} else {
					a.setAttribute(b, c[b]);
				}
			}
		}
	},
	lazyImg: function() {
		setTimeout(function() {
			for (var b = 0,
			c = document.images.length; b < c; b++) {
				var a = document.images[b];
				var d = a.getAttribute("data-src");
				if (d) {
					a.src = d;
					a.removeAttribute("data-src");
				}
			}
		},
		0);
	},
	formatNumber: function(c, a) {
		var b = parseInt((c || 1)),
		a = a || 9999;
		if (!b || b < 1) {
			b = 1;
		}
		if (b > a) {
			b = a;
		}
		return b;
	},
	getGoodsDetail: function() {
		var a = null,
		b = 0;
		if (GD.currentJoinGoods) {
			a = GD.currentJoinGoods;
			b = a.id;
		} else {
			b = GD.firstGoodsId;
		}
		$.ajax({
			url: "/mem_goods/?act=fetch_join_goods_info_new&goods_id=" + b,
			dataType: "json",
			success: function(e) {
				if (e) {
					if (e.gd_jilu) {
						$("#JS_Tab_body_jilu").html(e.gd_jilu);
					}
					if (e.sales_count - 0) {
						$("#JS_boughts_number_" + b).html(e.sales_count || 0);
						$("#JS_count_jilu").html("(" + e.sales_count + ")");
					}
					if (!a) {
						return;
					}
					a.changeGoodsDetail();
					if (e.json && e.json.error == 0) {
						if (e.json.stock && e.json.stock.g) {
							var h = (e.json.stock.nc + "").split(",");
							var d = (e.json.stock.dc + "").split(",");
							var g = [];
							var f = [];
							for (var c in h) {
								g = g.concat(e.json.stock.addr[h[c]]);
							}
							for (var c in d) {
								f = f.concat(e.json.stock.addr[d[c]]);
							}
							e.json.stock.nc = g;
							e.json.stock.dc = f;
							a.stock_info = e.json.stock;
						} else {
							if (e.json.stock == "no data") {
								a.stock_info = e.json.stock;
							}
						}
						a.checkProvinceStock(a.cityId);
					}
				}
			}
		});
	},
	toggleTab: function() {
		var e = ["xinxi", "guige", "expr", "pingjia", "sheji", "jilu", "shouhou", "xuzhi", "wenti"];
		var d = [];
		var b = e;
		var a = [];
		var c = $("#JS_Tab_body_pingjia");
		var f = GD.currentJoinGoods ? GD.currentJoinGoods.id: GD.firstMainGoods ? GD.firstMainGoods.id: GD.firstGoodsId;
		jQuery.each(e,
		function(g) {
			a = jQuery.merge(a, $("#JS_Tab_body_" + e[g]));
			var h = $("#JS_Tab_nav_" + e[g]);
			h.attr("data-key", e[g]);
			d = jQuery.merge(d, h);
		});
		a = $(a);
		d = $(d);
		d.click(function() {
			if (GD.navsIsFloat) {
				window.scroll(0, GD.navsOffsetTop - 1);
			}
			var j = d.index(this);
			var l = d.eq(j);
			var h = l.attr("data-key");
			d.removeClass("current").eq(j).addClass("current");
			a.hide().eq(j).show();
			c.show();
			if (h == "wenti") {
				var k = $("#JS_Tab_body_wenti_clone");
				var g = a.eq(j);
				g.hide();
				if (k.length > 0) {
					k.show();
				} else {
					var k = $('<div class="wenti mt10" id="JS_Tab_body_wenti_clone"></div>');
					k.html(g.html());
					if (c.prev().is("a")) {
						c.prev().before(k);
					}
				}
			} else {
				$("#JS_Tab_body_wenti_clone").hide();
				$("#JS_Tab_body_wenti").show();
			}
			_gaq.push(["_trackEvent", "goodsEvent", "TabNav_" + h, (this._type || "导航") + "_" + f]);
			this._type = "";
		});
		$(document).on("click", ".JS_wenti_tab li",
		function() {
			var h = $(this);
			var g = $(this).data("type");
			$(".JS_wenti_tab li").removeClass("current");
			$(".JS_wenti_tab_" + g).addClass("current");
			$(".went_body").addClass("none");
			$(".JS_went_body_" + g).removeClass("none");
			_gaq.push(["_trackEvent", "goodsEvent", "TabNav_wenti", g + "_" + f]);
		});
	},
	peitaoScroll: function() {
		var n = $("#JS_extra_change");
		if (n) {
			n.click(function(r) {
				var s = r.target,
				p = $(s);
				if (s.nodeName == "LI" && !p.hasClass("current")) {
					var q = $("#" + s.id + "_body");
					p.addClass("current").siblings().removeClass("current");
					q.removeClass("none").siblings().not(".extra_title").addClass("none");
					s = q = null;
				}
				return false;
			});
			n = null;
		}
		var l;
		if (window.LOAD) {
			l = {
				pt: {
					width: 172,
					num: 4
				},
				po: {
					width: 230,
					num: 4
				},
				zi: {
					width: 234,
					num: 4
				},
				tz: {
					width: 178,
					num: 3
				},
				mg: {
					width: 186,
					num: 5
				}
			};
		} else {
			l = {
				pt: {
					width: 168,
					num: 3
				},
				po: {
					width: 238,
					num: 3
				},
				zi: {
					width: 244,
					num: 3
				},
				tz: {
					width: 178,
					num: 2
				},
				mg: {
					width: 178,
					num: 4
				}
			};
		}
		a($("#JS_popular_left"), $("#JS_popular_right"), $("#JS_popular_table"), l.po.width, l.po.num);
		a($("#JS_zxitem_left"), $("#JS_zxitem_right"), $("#JS_zxitem_table"), l.zi.width, l.zi.num);
		function a(u, C, D, q, z, v, B, A) {
			if (!u.length || !C.length || !D.length) {
				return;
			}
			if (B) {
				var y = D.width(),
				p = Math.ceil(y / q),
				x = 0,
				w,
				r = q;
			} else {
				var t = A || D.find("td").length,
				p = Math.ceil(t / z),
				x = 0,
				w,
				r = q * z;
			}
			D.css({
				marginLeft: 0
			});
			if (p <= 1) {
				u.hide();
				C.hide();
			} else {
				u.css("display", "");
				C.css("display", "");
			}
			v = v || 300;
			var s = function(E) {
				x = x + E;
				if (x < 0) {
					x = p - 1;
				} else {
					if (x >= p) {
						x = 0;
					}
				}
				w = 0 - x * r;
				D.stop(true).animate({
					marginLeft: w + "px"
				},
				v);
			};
			u.click(function() {
				s( - 1);
			});
			C.click(function() {
				s(1);
			});
			u = C = null;
		}
		var e = $("#JS_maiguo_table");
		if (e.length) {
			a($("#JS_maiguo_left"), $("#JS_maiguo_right"), e, l.mg.width, l.mg.num);
			var k = e.find(".maiguo_box");
			k.mouseenter(function() {
				$(this).addClass("current");
			}).mouseleave(function() {
				$(this).removeClass("current");
			});
			k = null;
		}
		var f = $("#JS_tz_nav");
		if (f.length) {
			var i = f.find("li");
			var o = $("#JS_tz_body .peitao");
			f.click(function(t) {
				var u = t.target;
				var p = $(u);
				if (u.nodeName == "LI") {
					var r = p.attr("data-index"),
					q = p.attr("data-init"),
					s = i.index(u);
					if (!q) {
						c(r);
						p.attr("data-init", 1);
					}
					i.removeClass("current").eq(s).addClass("current");
					o.addClass("none").eq(s).removeClass("none");
				}
			});
			function c(p) {
				a($("#JS_tz_s" + p + "_left"), $("#JS_tz_s" + p + "_right"), $("#JS_tz_s" + p + "_table"), l.tz.width, l.tz.num);
			}
			c(1);
		}
		var d = $("#JS_tz_d1_table");
		if (d.length) {
			a($("#JS_tz_d1_left"), $("#JS_tz_d1_right"), d, (window.LOAD ? 740 : 555), "", "", true);
		}
		var g = $("#JS_pt_sky"),
		h = $("#JS_pt_stage");
		if (h.length) {
			var b = h.attr("data-first");
			a($("#JS_peitao_left"), $("#JS_peitao_right"), $("#JS_scroll_table"), l.pt.width, l.pt.num, "", "", b);
		}
		if (g.length) {
			var m = $("#JS_scroll_table"),
			j = m.find("td");
			g.click(function(t) {
				var u = t.target,
				p = $(u),
				q,
				r,
				s;
				if (u.nodeName != "A") {
					return;
				}
				q = p.attr("data-index");
				s = p.attr("data-count");
				p.addClass("current").siblings().removeClass("current");
				j.each(function(w) {
					var v = j.eq(w);
					if (v.attr("data-index") == q) {
						v.removeClass("none");
					} else {
						v.addClass("none");
					}
				});
				a($("#JS_peitao_left"), $("#JS_peitao_right"), $("#JS_scroll_table"), l.pt.width, l.pt.num, "", "", s);
			});
		}
	},
	formatImgPath: function(a) {
		return a.toString().indexOf("http") === 0 ? a: (IMG_HOST + a);
	},
	setCurrentById: function(a, b) {
		if (b && b == "copy") {
			GL[a].setCopyGoodsCurrent();
		} else {
			if (GL[a]) {
				GL[a].setJoinGoodsCurrent(true, true);
			}
		}
	},
	formatPrice: function(a) {
		a = (a + "").toString().replace("&yen;", "").replace("￥", "");
		return (a - 0).toFixed(2);
	},
	getTransPrice: function() {
		if (GD.getTransPriceAjaxHolder) {
			GD.getTransPriceAjaxHolder.abort();
			GD.getTransPriceAjaxHolder = null;
		}
		var n = "";
		var p = [];
		var i = 0;
		var j = {
			total_price: 0,
			discount: 0
		};
		var m = '<img src="/themes/meilele/images/loading.gif" width="16" height="16" />';
		var h = $("#JS_az1_feeInfo");
		var g = $("#JS_az2_feeInfo");
		h.html(m);
		g.html(m);
		p.push(GD.currentJoinGoods.id + ":" + GD.currentJoinGoods.number);
		j.total_price += GD.currentJoinGoods.attr.price_type.show_price * GD.currentJoinGoods.number;
		j.discount += (parseInt(GD.currentJoinGoods.attr.price_type.shop_price) - GD.currentJoinGoods.attr.price_type.show_price) * GD.currentJoinGoods.number;
		if (GD.currentJoinGoods.transType == "1") {
			n = "&is_logistics=" + GD.currentJoinGoods.id;
		}
		for (var c in GP) {
			if (GP[c] && GP[c].selected && GP[c].number) {
				p.push(GP[c].id + ":" + GP[c].number);
				i += GP[c].number;
				j.total_price += GP[c].attr.price_type.show_price * GP[c].number;
				j.discount += (parseInt(GP[c].attr.price_type.shop_price) - GP[c].attr.price_type.show_price) * GP[c].number;
			}
		}
		var o = $("#JS_pt_main_goods_number");
		var l = $("#JS_pt_peitao_goods_number");
		var d = $("#JS_pt_activity_goods");
		var e = $("#JS_pt_save_count");
		var b = $("#JS_pt_cost");
		var a = o.length && l.length && d.length && e.length;
		var f = function(H) {
			if (a) {
				b.html("&yen;" + GF.formatPrice(H.total_price));
				d.html(H.goods_notic || "");
				e.html(H.discount ? ('<span class="bold">节省：<span class="yen red">&yen;' + GF.formatPrice(H.discount) + "</span>  </span>") : "");
			}
			if (H.region_data && H.region_data.sheng && H.region_data.shi && H.region_data.qu) {
				$("#JS_anzhuang_text_sheng").html(H.region_data.sheng.region_name);
				GF.fillShi(H.region_data.shi);
				for (var D in GL) {
					var s = $("#JS_peisong_address_nav_" + D);
					var L = "";
					if (s.length) {
						for (var F = 0,
						B = H.region_data.shi.length; F < B; F++) {
							if (H.region_data.shi[F].checked) {
								GD.selectCityName = L = H.region_data.shi[F].region_name;
								GL[D].cityId = H.region_data.shi[F].region_id;
								GL[D].checkProvinceStock(H.region_data.shi[F].region_id);
								break;
							}
						}
						s.html(inArray(GD.municipalitiesId, H.region_data.sheng.region_id) ? L: H.region_data.sheng.region_name + L);
					}
					GL[D].provinceId = H.region_data.sheng.region_id;
					if (inArray(specailArea, H.region_data.sheng.region_id)) {
						GL[D].inSpecailArea = true;
					} else {
						GL[D].inSpecailArea = false;
					}
					if (GL[D].transType == "1") {
						GL[D].countPressFee();
					}
					GL[D].copyGoodschange();
				}
			}
			if (h.length) {
				if (GD.selectCityId && H.transfer_data && (H.transfer_data.bulk_count > 0 || H.transfer_data.weight_count > 0 || H.transfer_data.deliver_goods_count > 0)) {
					var w = "";
					var y = "";
					var x = "";
					var J = "";
					var I = "";
					var K = i + GD.currentJoinGoods.number;
					var z = "";
					var A = "";
					w = '共 <strong class="red">' + K + "</strong> 件商品，";
					if (H && typeof(H.transfer_data.deliver_goods_count) == "undefined") {
						H.transfer_data.deliver_goods_count = 0;
					}
					if (H && typeof(H.logistics_count) == "undefined") {
						H.logistics_count = 0;
					}
					if (H && typeof(H.transfer_data.bulk_count) == "undefined") {
						H.transfer_data.bulk_count = 0;
					}
					if (H && typeof(H.transfer_data.weight_count) == "undefined") {
						H.transfer_data.weight_count = 0;
					}
					if (H.transfer_data.bulk_count > 0) {
						if (H.server_vol && H.server_vol.length > 0) {
							bulk = '<b class="red">' + H.transfer_data.bulk_count + '</b> 件按体积计算运费，包装体积约 <strong class="red">' + H.transfer_data.bulk + "</strong> 立方米，参考费用如下：";
							for (var F = 0,
							B = H.server_vol.length; F < B; F++) {
								J += '<span style="display:inline-block;height:20px;line-height:20px;border:1px solid #ddd;margin:1px;padding:0 10px;color:#666">' + H.server_vol[F].region_name + "&ensp;" + H.server_vol[F].min_price + "元</span>";
							}
						} else {
							bulk = '<b class="red">' + H.transfer_data.bulk_count + '</b> 件按体积计算运费，包装体积约 <strong class="red">' + H.transfer_data.bulk + '</strong> 立方米，参考费用为：<strong class="red">' + H.transfer_data.fee + "</strong> 元";
						}
						y += '<div class="infos mt10">' + w + bulk + "</div>";
						y += '<div class="infos mt10">' + J + "</div>";
					}
					if (H.transfer_data.weight_count > 0) {
						if (H.service_wei && H.service_wei.length > 0) {
							weight = '<b class="red">' + H.transfer_data.weight_count + '</b> 件按重量计算运费，包装重量约 <strong class="red">' + H.transfer_data.goods_weight + "</strong> 公斤，参考费用如下：";
							for (var E = 0,
							G = H.service_wei.length; E < G; E++) {
								I += '<span style="display:inline-block;height:20px;line-height:20px;border:1px solid #ddd;margin:1px;padding:0 10px;color:#666">' + H.service_wei[E].region_name + "&ensp;" + H.service_wei[E].min_price + "元</span>";
							}
						} else {
							weight = '<b class="red">' + H.transfer_data.weight_count + '</b> 件按重量计算运费，包装重量约 <strong class="red">' + H.transfer_data.goods_weight + '</strong> 公斤，参考费用为：<strong class="red">' + H.transfer_data.weight_fee + "</strong> 元";
						}
						if (H.transfer_data.bulk_count > 0) {
							y += '<div class="infos mt10">' + A + weight + "</div>";
						} else {
							y += '<div class="infos mt10">' + w + A + weight + "</div>";
						}
						y += '<div class="infos mt10">' + I + "</div>";
					}
					var M = H.transfer_data.deliver_goods_count - H.logistics_count;
					if (H && H.transfer_data.deliver_weight > 0 && M > 0) {
						x += '<b class="red">' + M + '</b> 件快递商品，包装重量约 <b class="red">' + H.transfer_data.deliver_weight + "</b> 公斤，参考运费：" + H.transfer_data.deliver_weight_fee + " 元<br/>";
					}
					if (GD.selectCityId && H && H.logistics_count > 0) {
						x += '<b class="red">' + H.logistics_count + "</b> 件包快递商品";
						if (inArray(specailArea, H.transfer_data.province)) {
							var t = 6;
							if (typeof(free_add_unit_fee) == "number") {
								t = free_add_unit_fee;
							}
							var C = Math.ceil(H.transfer_data.deliver_free_weight) * t;
							x += '，您选择的地区需要补加运费，参考费用为：<b class="red">' + C + "</b> 元<br/>";
						} else {
							x += "<br/>";
						}
					}
					if (GD.selectCityId && H && H.is_postfree_num > 0) {
						x += '包物流商品由美乐乐按最高180元/立方、0.2元/公斤补贴运费，具体可<a href="javascript:;" onclick="mchat.openui();return false;">咨询在线客服</a>。';
					}
					if (K != H.transfer_data.bulk_count + H.transfer_data.weight_count + H.transfer_data.deliver_goods_count) {
						y = false;
					}
					if (!y && !x) {
						y = "";
						x = '<div class="infos mt10"><span class="icon2"></span> <span class="red inline">目的地不在列表范围内，或有商品未记录体积、重量，请咨询客服！</span></div>';
					}
					y += '<div class="infos mt10">' + x + "</div>";
				} else {
					y = '<div class="infos mt10"><span class="icon2"></span> <span class="red inline">目的地不在列表范围内，或有商品未记录体积、重量，请咨询客服！</span></div>';
				}
				h.html(y);
			}
			var r = "";
			if (g.length) {
				if (GD.selectCityId && H && H.expr && H.expr.length) {
					var v = [];
					for (var D = 0,
					u = H.expr.length; D < u; D++) {
						v.push('“<a href="javascript:;" onclick="GF.showExprBox({expr_name:\'' + H.expr[D].expr_name + "',phone:'" + H.expr[D].phone + "',addr:'" + H.expr[D].addr + "',open_detail:'" + H.expr[D].open_detail + "',sale_time:'" + H.expr[D].sale_time + "',expr_id:'" + H.expr[D].expr_id + "',manager_front_id:'" + H.expr[D].manager_front_id + "'});\">" + H.expr[D].expr_name + "</a>”");
					}
					r += '<div class="infos mt10">该区域可由' + (v.join("，")) + "提供服务。</div>";
				}
				if (GD.selectCityId && H && H.service_list && H.service_list.length) {
					var w = "";
					if (H.min_fee > 0) {
						r += '<div class="infos mt10">服务费<span class="red">(此处仅计算当前所选商品服务费，各区根据情况不同，有不同的最低金额限制，不满起步价的按起步价收取，详见<a class="red" href="/article_cat-23/article-3206.html" target="_blank">《体验馆服务费》</a>)</span>；非电梯上楼费用另计。</div>';
					}
					for (var D = 0,
					u = H.service_list.length; D < u; D++) {
						w += '<span style="display:inline-block;height:20px;line-height:20px;border:1px solid #ddd;margin:1px;padding:0 10px;color:#666">' + H.service_list[D].region_name + "&ensp;" + H.service_list[D].min_fee + "元</span>";
					}
					r += '<div class="infos mt10">' + w + "</div>";
				} else {
					r += '<span class="icon2"></span> <span class="red inline">未设体验馆或该区域暂无数据，请选择方式B：自提货、自安装！</span>';
				}
				if (GD.selectCityId && H && H.is_postfree_num > 0) {
					r += '<div class="infos mt10">包物流商品，服务费已按 <strong class="red">' + H.sale_discount + "</strong> 折计算在内。 </div>";
				}
				r = r || '<span class="icon2"></span> <span class="red inline">' + GD.transNoExprText + "</span>";
				g.html(r);
			}
		};
		if (a) {
			o.html(GD.currentJoinGoods.number);
			l.html(i ? ('<span class="gray">|</span> 配套商品 <strong class="red">' + i + "</strong> 件") : "");
			b.html("");
			e.html("...");
		}
		var q = $("#JS_express_nav_" + GD.currentJoinGoods.id);
		if (GD.transPriceBoxIsShow || (q.length && q.css("display") != "none" && !q.hasClass("none"))) {
			GD.getTransPriceAjaxHolder = $.ajax({
				url: "/ajax_goods/?act=goodsPageInfo&id=" + GD.firstMainGoods.id + "&distinct_id=" + (GD.selectCityId || "") + "&cmd=" + p.join("|") + n,
				dataType: "json",
				cache: false,
				success: function(k) {
					f(k);
					GD.getTransPriceAjaxHolder = null;
				},
				error: function() {
					GD.getTransPriceAjaxHolder = null;
				}
			});
		} else {
			f(j);
		}
	},
	floatNavs: function() {
		GD.floatNavs = $("#JS_float_navs");
		$(window).scroll(function() {
			var b = GD.floatNavs;
			var c = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
			var a = GD.navsOffsetTop = $("#JS_float_navs_position").offset().top;
			if (c > a) {
				b.addClass("floatTop");
				GD.navsIsFloat = true;
			} else {
				b.removeClass("floatTop");
				GD.navsIsFloat = false;
			}
			if (!GD.lazyCommentAjax && c > a - (window.innerHeight || 500)) {
				GF.getPingJia("new");
				GF.getZixun();
				GD.lazyCommentAjax = true;
			}
		});
	},
	getSaleRecord: function(b) {
		if (b === false) {
			var a = $("#JS_sale_record_page_input");
			b = parseInt(a.val());
			a = b;
		}
		if (!b) {
			b = 1;
		}
		$.ajax({
			url: "/ajax_goods/?act=getSaleRecord&new=1&id=" + (GD.currentJoinGoods ? GD.currentJoinGoods.id: GD.firstGoodsId) + "&page=" + b,
			success: function(c) {
				if (GD.currentJoinGoods) {
					GL[GD.currentJoinGoods.id].boughtNotes = c;
				}
				$("#JS_Tab_body_jilu").html(c);
			}
		});
	},
	pingjia: function() {
		if (GD.firstMainGoods) {
			if (winDialog && winDialog.showDialog) {
				winDialog.showDialog(0, GD.firstMainGoods.id);
			} else {
				$.req("mll_comment.min.js?0915",
				function() {
					winDialog.showDialog(0, GD.firstMainGoods.id);
				});
			}
		}
	},
	createCommentHtml: function(q) {
		var b = GD.firstMainGoods ? GD.firstMainGoods.id: GD.firstGoodsId;
		if (q.comments_count > 0) {
			var c = $("#JS_comment_num_" + b),
			o = $("#JS_count_pingjia");
			c.html(q.comments_count);
			o.html("(" + q.comments_count + ")");
		}
		var h = [];
		h.push('<div class="tab_title"><span class="icon"></span><h2>客户评价</h2></div>');
		if (q.comment_list || q.only_show_list) {
			h.push('<div class="tab_body"><table class="pj_tb"><tr><td class="t1"><strong>');
			h.push(q.comments_percent.per_ch);
			h.push('%</strong><br /><span>满意度</span></td><td class="t2"><div class="bar_box">&emsp;满意<span class="bar"><span class="in" style="width:');
			h.push(q.comments_percent.per_ch);
			h.push('%"></span></span>');
			h.push(q.comments_percent.per_ch);
			h.push('%</div><div class="bar_box">&emsp;一般<span class="bar"><span class="in" style="width:');
			h.push(q.comments_percent.per_cz);
			h.push('%"></span></span>');
			h.push(q.comments_percent.per_cz);
			h.push('%</div><div class="bar_box">不满意<span class="bar"><span class="in" style="width:');
			h.push(q.comments_percent.per_cc);
			h.push('%"></span></span>');
			h.push(q.comments_percent.per_cc);
			h.push('%</div></td><td class="td3">写购物评价，即可获得<a href="/article_cat-6/article-6391.html" target="_blank" class="red">50元或100元红包</a>。详见<a class="red" href="/article_cat-6/article-6391.html" title="评价红包使用规则" target="_blank">《评价红包使用规则》</a><br/><br/>传秀家美图，获精美大奖！随手上传商品图片、配简单文字，<a href="/xspace/" target="_blank" class="red">坐等大奖</a>！详见<a href="/xspace/#rules" target="_blank" class="red">《秀家评奖规则》</a></td><td class="td4">我在美乐乐购买过此商品<br /><a href="javascript:;" onclick="GF.pingjia();return false;" class="g2_btn2">我要评价</a><a class="red" href="/goods_comments-');
			h.push(b);
			h.push('-1.html" target="_blank">[所有评价]</a><br/><a href="/xspace/publish.html" target="_blank" class="g2_btn2 g2_btn5">我要秀家</a><a class="red" href="/xspace/goods-');
			h.push(b);
			h.push('.html" target="_blank">[所有秀家]</a></td></tr></table></div>');
			h.push('<div class="in_title"><a href="javascript:;" onclick="GF.getPingJia(\'new\',1,\'\',true);" class="allpingjia' + (q.slash ? "": " red") + '">全部评价(');
			h.push(q.comments_count);
			h.push(')</a><a href="javascript:;"' + (q.slash == "high" ? ' class="red"': "") + " onclick=\"GF.getPingJiaBySlash(this,'high');\">满意(");
			h.push(q.comment_level_count.high || 0);
			h.push(')</a><a href="javascript:;"' + (q.slash == "middle" ? ' class="red"': "") + " onclick=\"GF.getPingJiaBySlash(this,'middle');\">一般(");
			h.push(q.comment_level_count.middle || 0);
			h.push(')</a><a href="javascript:;"' + (q.slash == "low" ? ' class="red"': "") + " onclick=\"GF.getPingJiaBySlash(this,'low');\">不满意(");
			h.push(q.comment_level_count.low || 0);
			h.push(')</a><a href="javascript:;"' + (q.slash == "only_show" ? ' class="red"': "") + " onclick=\"GF.getPingJiaBySlash(this,'only_show');\"><b>秀家</b>(");
			h.push(q.comment_level_count.only_show || 0);
			h.push(")</a></div>");
			h.push('<div class="tab_body p5"><table class="cm_list" cellspacing="15">');
			if (q.comment_list) {
				if (q.show_home_goods_html) {
					h.push(q.show_home_goods_html);
				}
				for (var g = 0,
				d = q.comment_list.length; g < d; g++) {
					var p = q.comment_list[g];
					h.push('<tr><td class="td1"><div class="img">');
					if (p.zx_user_url) {
						h.push('<a class="red" target="_blank" href="');
						h.push(p.zx_user_url);
						h.push('">');
					}
					h.push('<img src="');
					h.push(p.zx_user_avatar || $.__IMG + "/ucenter/images/noavatar_middle.gif");
					h.push('" width="96" height="96" />');
					if (p.zx_user_url) {
						h.push("</a>");
					}
					h.push('</div><div class="info c">');
					if (p.zx_user_url) {
						h.push('<a class="red" target="_blank" href="');
						h.push(p.zx_user_url);
						h.push('">');
						h.push(p.user_name || "匿名用户");
						h.push("</a>");
					} else {
						h.push('<span class="red">');
						h.push(p.user_name || "匿名用户");
						h.push("</span>");
					}
					h.push('</div></td><td class="td2"><div class="arrow"></div><div class="clearfix in_t"><div class="Left"><span>');
					h.push(p.rank);
					h.push('</span> <span class="cm_star cm_star_');
					h.push(p.comment_rank);
					h.push('"></span></div><div class="Right gray">');
					h.push(p.add_time);
					h.push('</div></div><div class="content">');
					h.push(p.content);
					if (p.id_value && GD.joinList && GD.joinList[p.id_value]) {
						h.push('<br/>类型：<a href="' + GD.joinList[p.id_value].url + '" target="_blank">');
						h.push(GD.joinList[p.id_value].name + "</a>");
					}
					h.push("</div>");
					if (p.re_content) {
						h.push('<div class="re_content"><strong class="gray"><a href="#" target="_blank" class="gray">美美</a>回复：</strong>');
						h.push(p.re_content);
						h.push("</div>");
					}
					h.push("</td></tr>");
				}
			} else {
				for (var f = 0,
				n = q.only_show_list.length; f < n; f++) {
					var p = q.only_show_list[f];
					h.push('<tr><td class="show_left"><div class="td1"><div class="img">');
					if (p.zx_user_url) {
						h.push('<a class="red" target="_blank" href="');
						h.push(p.zx_user_url);
						h.push('">');
					}
					h.push('<img src="');
					h.push(p.zx_user_avatar || $.__IMG + "/ucenter/images/noavatar_middle.gif");
					h.push('" width="96" height="96" />');
					if (p.zx_user_url) {
						h.push("</a>");
					}
					h.push('</div><div class="info c">');
					if (p.zx_user_url) {
						h.push('<a class="red" target="_blank" href="');
						h.push(p.zx_user_url);
						h.push('">');
						h.push(p.user_name || "匿名用户");
						h.push("</a>");
					} else {
						h.push('<span class="red">');
						h.push(p.user_name || "匿名用户");
						h.push("</span>");
					}
					h.push('</div></div></td><td class="td2"><div class="arrow"></div><div class="clearfix in_t"><div class="Left"><span>满意</span> <span class="cm_star"></span></div><div class="Right gray">');
					h.push(p.add_time);
					h.push('</div></div><div class="clearfix com_show"><div class="Left red bold show_name">秀家：</div><div class="content Right"><div class="img_area">');
					for (var e = 0,
					a = p.pic_list.length; e < a; e++) {
						var m = p.pic_list[e];
						h.push('<a href="/xspace/show-' + p.tid + "-");
						h.push(m.id);
						h.push('.html" title="');
						h.push(p.s_title);
						h.push('" target="_blank" onclick="_gaq.push([\'_trackEvent\',\'goodsComXs\',document.URL,this.href]);"><img src="');
						h.push(m.url);
						h.push('" width="150" height="96" /></a>');
					}
					h.push('</div><p class="show_text">');
					h.push(p.content);
					h.push('<a href="');
					h.push(p.url);
					h.push('" title="');
					h.push(p.title);
					h.push('" target="_blank" class="red" onclick="_gaq.push([\'_trackEvent\',\'goodsComXs\',document.URL,this.href]);">查看秀家&gt;&gt;</a></p><div class="xspace_extend clearfix"><div class="Left"><a href="');
					h.push(p.url);
					h.push('" target="_blank" onclick="_gaq.push([\'_trackEvent\',\'goodsComXs\',document.URL,this.href]);"><span class="xspace_icon love_l"></span><span class="xspace_icon love_r red">');
					h.push(p.love_count || 0);
					h.push('</span></a></div><div class="Left"><span class="xspace_icon goods_cmt_show"></span><a href="');
					h.push(p.url);
					h.push('#reply_box" class="comment_t" target="_blank" onclick="_gaq.push([\'_trackEvent\',\'goodsComXs\',document.URL,this.href]);"><span>评论</span><span class="red">(');
					h.push(p.comment_count || 0);
					h.push(')</span></a></div><div class="Left"></div></div></div></div></td></tr>');
				}
			}
			h.push("</table>");
			h = h.concat(GF.parsePageHtml(q));
			h.push("</div>");
		} else {
			h.push('<div class="tab_body"><div class="no_pingjia c gray">暂无商品评价，<a class="red" href="javascript:;" onclick="GF.pingjia();return false;" title="我要评价">点此评价</a>。争抢商品评价，赚取现金红包！先评有惊喜！<br/>凡购买客户参与当前购买产品评价，即可获得<a href="/article_cat-6/article-6391.html" target="_blank" class="red">50元或100元红包</a>。<br/><a href="/xspace/publish.html" target="_blank" class="red">传秀家美图</a>，获精美大奖！随手上传商品图片、配简单文字，坐等大奖！详见<a href="/xspace/#rules" target="_blank" class="red">《秀家评奖规则》</a></div></div>');
		}
		return h.join("");
	},
	parsePageHtml: function(e) {
		var d = [];
		if (e) {
			d.push('<div class="mt20 r page">');
			if (e.current > 1) {
				d.push('<a href="javascript:;" onclick="GF.getPingJiaBySlash(null,\'');
				d.push(e.slash);
				d.push("',");
				d.push(e.previous_page);
				d.push(');return false;"><span class="arrow"><span class="aleft">◆</span></span>上一页</a>');
			}
			if (e.current > 5) {
				d.push('<a href="javascript:;" class="bold" onClick="GF.getPingJiaBySlash(null,\'');
				d.push(e.slash);
				d.push("',1);return false;\">1</a>...");
			} else {
				if (e.current > 4) {
					d.push('<a href="javascript:;" class="bold" onClick="GF.getPingJiaBySlash(null,\'');
					d.push(e.slash);
					d.push("',1);return false;\">1</a>");
				}
			}
			for (var c = 0,
			a = e.page_numbers.length; c < a; c++) {
				var b = e.page_numbers[c];
				if (b == e.current) {
					d.push("<strong>");
					d.push(b);
					d.push("</strong>");
				} else {
					if (b + 3 >= e.current && b - 3 <= e.current) {
						d.push('<a href="javascript:;" class="bold" onClick="GF.getPingJiaBySlash(null,\'');
						d.push(e.slash);
						d.push("',");
						d.push(b);
						d.push(');return false;">');
						d.push(b);
						d.push("</a>");
					}
				}
			}
			if (e.current + 4 < e.totalpage) {
				d.push('...<a href="javascript:;" class="bold" onClick="GF.getPingJiaBySlash(null,\'');
				d.push(e.slash);
				d.push("',");
				d.push(e.totalpage);
				d.push(');return false;">');
				d.push(e.totalpage);
				d.push("</a>");
			} else {
				if (e.current + 4 == e.totalpage) {
					d.push('<a href="javascript:;" class="bold" onClick="GF.getPingJiaBySlash(null,\'');
					d.push(e.slash);
					d.push("',");
					d.push(e.totalpage);
					d.push(');return false;">');
					d.push(e.totalpage);
					d.push("</a>");
				}
			}
			if (e.current < e.totalpage) {
				d.push('<a href="javascript:;" onclick="GF.getPingJiaBySlash(null,\'');
				d.push(e.slash);
				d.push("',");
				d.push(e.next_page);
				d.push(');return false;">下一页<span class="arrow"><span class="aright">◆</span></span></a>');
			}
			d.push('&ensp;<em>到第 </em><input class="to_page" value="');
			d.push(e.current);
			d.push('" id="JS_pingjia_input" /><em> 页</em><a class="current" href="javascript:;" onclick="GF.getPingJiaBySlash(null,\'');
			d.push(e.slash);
			d.push("',false);return false;\">确定</a></div>");
		}
		return d;
	},
	zixun: function() {
		if (GD.firstMainGoods) {
			if (winDialog && winDialog.showDialog) {
				winDialog.showDialog(1, GD.firstMainGoods.id);
			} else {
				$.req("mll_comment.min.js?0915",
				function() {
					winDialog.showDialog(1, GD.firstMainGoods.id);
				});
			}
		}
	},
	getPingJia: function(d, e, c, f) {
		if (!e) {
			e = 1;
		}
		var a = arguments.length,
		g = GD.firstMainGoods ? GD.firstMainGoods.id: GD.firstGoodsId,
		b = "/mem_goods/?act=getCommentRecord&id=" + g + "&page=" + e + "&sort=" + d;
		b += c ? "&slash=" + c: "";
		$.ajax({
			url: b,
			dataType: "json",
			success: function(i) {
				var h = GF.createCommentHtml(i);
				$("#JS_Tab_body_pingjia").html(h);
				if (a != 1) {
					location.hash = "";
					location.hash = "#pj";
				}
			}
		});
		if (f) {
			_gaq.push(["_trackEvent", "goodsEvent", "pingjia_" + (c || "all"), g]);
		}
	},
	getPingJiaBySlash: function(e, b, d) {
		var g = false;
		if (d === false) {
			var c = $("#JS_pingjia_input");
			d = parseInt(c.val());
			c = d;
		}
		d = d || 1;
		if (e) {
			var f = e.innerHTML,
			a = f.match(/\d+/)[0],
			h = GD.currentJoinGoods ? GD.currentJoinGoods.id: GD.firstMainGoods ? GD.firstMainGoods.id: GD.firstGoodsId;
			if (a == 0) {
				return;
			}
			g = true;
		}
		GF.getPingJia("new", d, b, g);
	},
	getZixun: function(b) {
		if (b === false) {
			var a = $("#JS_zixun_page_input");
			b = parseInt(a.val());
			a = b;
		}
		if (!b) {
			b = 1;
		}
		$.ajax({
			url: "/mem_goods/?act=getAskRecord&new=1&id=" + (GD.firstMainGoods ? GD.firstMainGoods.id: GD.firstGoodsId) + "&page=" + b,
			dataType: "json",
			success: function(d) {
				var c = GF.parseZixunHtml(d);
				$("#JS_Tab_body_zixun").html(c);
			}
		});
	},
	buyAll: function() {
		var b = {};
		b[GD.currentJoinGoods.id] = GD.currentJoinGoods.number;
		for (var a in GP) {
			var c = GP[a];
			if (GP[a] && GP[a].selected && GP[a].number) {
				var d = GP[a].id;
				b[d] = GP[a].number;
			}
		}
		$.addToCart(GD.firstMainGoods.id, b, null, {
			is_logistics: GD.currentJoinGoods.transType || ""
		});
	},
	selectSheng: function(e, d) {
		GD.selectCityId = null;
		var a = false;
		if (e == 2) {
			this.selectShi(35, d);
			a = true;
		} else {
			if (e == 10) {
				this.selectShi(110, d);
				a = true;
			} else {
				if (e == 3) {
					this.selectShi(36, d);
					a = true;
				} else {
					if (e == 23) {
						this.selectShi(271, d);
						a = true;
					}
				}
			}
		}
		$("#JS_anzhuang_text_sheng").html("载入中...");
		$("#JS_anzhuang_text_shi").html("请选择市");
		GF.removeCurrent("sheng");
		$("#JS_anzhuang_shi").addClass("none");
		var c = $("#JS_az1_feeInfo");
		var b = $("#JS_az2_feeInfo");
		c.html('<span class="icon2"></span> <span class="red inline">目的地不在列表范围内，或有商品未记录体积、重量，请咨询客服！</span>');
		b.html('<span class="icon2"></span> <span class="red inline">' + GD.transNoExprText + "</span>");
		if (a) {
			$("#JS_anzhuang_text_sheng").html(d);
			return;
		}
		$.ajax({
			url: '/ajax_ajax/?act=data_center&module=common&method=getRegionByParentId&param={"parent_id":' + e + "}",
			dataType: "json",
			cache: true,
			success: function(f) {
				$("#JS_anzhuang_text_sheng").html(d);
				if (f && f.error == 0 && f.region_list && f.region_list.length) {
					GF.fillShi(f.region_list);
					$("#JS_anzhuang_shi").removeClass("none");
					GF.setCurrent("shi");
				}
			}
		});
	},
	fillShi: function(b) {
		var c = "";
		$("#JS_anzhuang_shi").removeClass("none");
		for (var a = 0,
		d = b.length; a < d; a++) {
			b[a].region_name = GF.trim(b[a].region_name);
			c += '<a class="l" href="javascript:GF.selectShi(\'' + b[a].region_id + "', '" + b[a].region_name + "')\">" + b[a].region_name + "</a>";
			if (b[a].checked) {
				$("#JS_anzhuang_text_shi").html(b[a].region_name);
				GD.selectCityId = b[a].region_id;
			}
		}
		$("#JS_anzhuang_list_shi").html(c);
	},
	selectShi: function(b, a) {
		GD.selectCityId = b;
		GF.getTransPrice();
		$("#JS_anzhuang_text_shi").html(a);
		GF.removeCurrent("shi");
	},
	anzhuang_list: ["sheng", "shi", "qu"],
	setCurrent: function(b) {
		for (var a = 0; a < 3; a++) {
			var c = $("#JS_anzhuang_" + GF.anzhuang_list[a]);
			if (!c.length) {
				continue;
			}
			if (b == GF.anzhuang_list[a]) {
				c.addClass("current");
			} else {
				GF.removeCurrent(GF.anzhuang_list[a]);
			}
		}
	},
	removeCurrent: function(a) {
		var b = $("#JS_anzhuang_" + a);
		if (!b.length) {
			return;
		}
		b.removeClass("current");
	},
	showExprBox: function(a) {
		GF.removeExprBox();
		var b = '<div style="width:450px;margin:0 auto;background:#fff;border:1px solid #ddd;"><div class="clearfix" style="height:30px;background:url(' + IMG_HOST + 'images/goods2/bg.png) 0px -305px repeat-x"><b class="Left" style="font-size:14px;line-height:30px;padding-left:10px;">' + a.expr_name + '</b><a class="Right" href="javascript:;" onclick="GF.removeExprBox();return false;" style="width:16px;height:16px;line-height:16px;margin-right:10px;text-align:center;background:#a6a6a6;margin-top:7px;color:#fff;font-weight:bold;border-bottom:1px solid #f2f2f2">&times;</a></div><div style="padding:10px 20px 20px;line-height:30px;"><div>营业时间：' + (a.open_detail ? '<span class="red">' + a.open_detail + "</span>": a.sale_time) + "</div><div>展馆地址：" + a.addr + "</div><div>联系电话：" + a.phone + '</div><div style="line-height:24px;padding-top:5px;"><input id="JS_anzhuang_expr_phone_input" onkeyup="this.value=(this.value+\'\').replace(/\\D/g,\'\')" style="border:1px solid #c7c7c7;padding:0 2px;height:22px;width:10em;margin-right:3px;" placeholder="请输入您的手机号" /><a href="javascript:;" style="vertical-align:top;display:inline-block;padding:0 10px;background:#c50000;color:#fff!important;border-radius:4px;" onclick="$.sendSms(\'' + a.expr_id + "',{phoneNumber:$('#JS_anzhuang_expr_phone_input').val() || false,autoSend:!!$('#JS_anzhuang_expr_phone_input').val() || false});return false;\">免费发送地址到手机</a></div></div></div>";
		GD.exprLightBox = $.lightBox(b, {},
		true);
	},
	removeExprBox: function() {
		if (GD.exprLightBox) {
			GD.exprLightBox.parentNode.removeChild(GD.exprLightBox);
			GD.exprLightBox = false;
		}
	},
	formatTime: function(e) {
		if (e < 0) {
			e = 0;
		}
		var c = e % 60;
		if (c < 10) {
			c = "0" + c;
		}
		var a = parseInt(e % 3600 / 60);
		if (a < 10) {
			a = "0" + a;
		}
		var b = parseInt(e % (3600 * 24) / 3600);
		if (b < 10) {
			b = "0" + b;
		}
		var f = parseInt(e / (3600 * 24));
		return '<span class="red bold">' + f + '</span>天<span class="red bold">' + b + '</span>小时<span class="red bold">' + a + "</span>分";
	},
	showTransPriceBox: function() {
		var d = GD.currentJoinGoods ? GD.currentJoinGoods.id: GD.firstMainGoods ? GD.firstMainGoods.id: GD.firstGoodsId;
		if (_gaq) {
			_gaq.push(["_trackEvent", "goodsEvent", "yunshuFee", d]);
		}
		var c = $("#JS_float_anzhuang_2");
		if (c.length) {
			var b = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
			if (window.innerWidth) {
				var a = window.innerWidth;
			} else {
				if ((document.body) && (document.body.clientWidth)) {
					var a = document.body.clientWidth;
				}
			}
			c.css({
				display: "block",
				top: b + 50 + "px",
				left: parseInt(((a - 500) / 2)) + "px"
			});
			GD.transPriceBoxIsShow = true;
		}
		GF.moveAnzhuangBox();
		GF.getTransPrice();
		return false;
	},
	hideTransPriceBox: function() {
		var a = $("#JS_float_anzhuang_2");
		if (a.length) {
			a.hide();
			GD.transPriceBoxIsShow = false;
		}
	},
	moveAnzhuangBox: function() {
		var c = $("#JS_float_click");
		var b = 0;
		var a = 0;
		if (!c.length) {
			return false;
		}
		c.mouseover(function() {
			this.style.cursor = "move";
		});
		c.mouseout(function() {
			this.style.cursor = "default";
		});
		c.mousedown(function(e) {
			var d = e || event,
			f = document.getElementById("JS_float_anzhuang_2");
			this.style.cursor = "move";
			b = d.clientX - f.offsetLeft;
			a = d.clientY - f.offsetTop;
			document.onmousemove = function(j) {
				var g = j || event,
				k = document.getElementById("JS_float_anzhuang_2");
				var i = g.clientX - b;
				var h = g.clientY - a;
				if (i < 0) {
					i = 0;
				}
				if (i > document.documentElement.clientWidth - k.offsetWidth - 2) {
					i = document.documentElement.clientWidth - k.offsetWidth - 2;
				}
				if (h < 0) {
					h = 0;
				}
				k.style.left = i + "px";
				k.style.top = h + "px";
				k = null;
			};
			document.onmouseup = function() {
				document.onmousemove = null;
				document.onmouseup = null;
			};
			f = null;
			return false;
		});
		mDiv = c = null;
	},
	setCookie: function(c) {
		if (c) {
			var e = new Date();
			var g = $.cookie("viewInfo");
			if (g) {
				var a = g.split("|");
				for (var f = 0; f < a.length; f++) {
					a[f] = a[f].split(",");
				}
			} else {
				var a = [];
			}
			a.push([c, e.getTime()]);
			a = a.sort(function(i, h) {
				return (h[1] - 0) - (i[1] - 0);
			});
			if (a.length > 10) {
				a.length = 10;
			}
			var d = [];
			for (var b = 0; b < a.length; b++) {
				if (!a[b] || !a[b][0] || !a[b][1]) {
					continue;
				}
				d[b] = (a[b][0] - 0) + "," + (a[b][1] - 0);
			}
			var d = d.join("|");
			$.cookie("viewInfo", d, 365, "meilele.com");
		}
	},
	createInput: function(b, a) {
		if (!b) {
			return;
		}
		a = a || {};
		for (var d in a) {
			var c = document.createElement("input");
			c.name = d;
			c.type = "hidden";
			c.value = a[d];
			b.appendChild(c);
		}
	},
	trim: function(c) {
		var b = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,
		a = String.prototype.trim;
		return a && !a.call("\uFEFF\xA0") ? (c == null ? "": a.call(c)) : (c == null ? "": (c + "").replace(b, ""));
	},
	buy: function(b) {
		b = b || "";
		if (!b) {
			return;
		}
		var a = {};
		a[b] = 1;
		$.addToCart(b, a, null, {
			is_logistics: ""
		});
	},
	exprTipTab: function(d) {
		d = d || GD.currentJoinGoods.id;
		var e = $("#JS_panel_tip_expr_" + d),
		c = $("#JS_panel_tip_expr_url_" + d),
		g = $("#JS_expr_url"),
		n = $.cookie("region_id");
		if (exprListKeyCityId && exprListKeyCityId[n] && exprListKeyCityId[n].list) {
			var j = [],
			b = exprListKeyCityId[n].list,
			o = b.length,
			p = exprListKeyCityId[n].city_name,
			m = exprListKeyCityId[n].pinyin,
			a = "/" + m + "/expr.html";
			for (var f in b) {
				j.push('<a href="/' + m + "/visit-" + b[f].expr_id + '.html" target="_blank" class="bold" title="参观' + b[f].short_expr_name + '">' + b[f].short_expr_name + "</a>");
			}
			e.html("美乐乐体验馆已在" + p + "开设" + j.join("、") + "！为客户提供购物、配送、安装、装修设计等家居一条龙服务。");
			c.attr("href", a);
			g.attr("href", a);
			$(".JS_send_expr_adress").removeClass("none").attr("data-region_id", n);
		} else {
			e.html("美乐乐体验馆已全面覆盖全国主要一线城市！为客户提供购物、配送、安装、装修设计等家居一条龙服务。");
			c.attr("href", "/expr.html");
		}
		e = c = null;
	},
	addEvent: function(d, c, b, a) {
		if (typeof d.addEventListener != "undefined") {
			if (c === "mouseenter") {
				d.addEventListener("mouseover", GF.withinElement(b), a);
			} else {
				if (c === "mouseleave") {
					d.addEventListener("mouseout", GF.withinElement(b), a);
				} else {
					d.addEventListener(c, b, a);
				}
			}
		} else {
			if (typeof d.attachEvent != "undefined") {
				d.attachEvent("on" + c,
				function() {
					b.apply(d, arguments);
				});
			} else {
				d["on" + c] = b;
			}
		}
	},
	removeEvent: function(d, c, b, a) {
		if (typeof d.removeEventListener != "undefined") {
			if (c === "mouseenter") {
				d.removeEventListener("mouseover", GF.withinElement(b), a);
			} else {
				if (c === "mouseleave") {
					d.removeEventListener("mouseout", GF.withinElement(b), a);
				} else {
					d.removeEventListener(c, b, a);
				}
			}
		} else {
			if (d.detachEvent) {
				d.detachEvent("on" + c, b);
			} else {
				d["on" + c] = null;
			}
		}
	},
	withinElement: function(a) {
		return function(c) {
			c = c || window.event;
			var b = c.relatedTarget;
			while (b && b != this) {
				try {
					b = b.parentNode;
				} catch(c) {
					break;
				}
			}
			if (b != this) {
				a.call(this, c);
			}
		};
	},
	timeFormart: function(c) {
		c = c || false;
		var e = new Date(),
		b = {};
		b.y = e.getFullYear(),
		b.m = e.getMonth() + 1,
		b.e = e.getDate(),
		b.h = e.getHours(),
		b.i = e.getMinutes(),
		b.s = e.getSeconds();
		if (c) {
			for (var a in b) {
				if (b[a] < 10) {
					b[a] = "0" + b[a];
				}
			}
		}
		return b.y + "-" + b.m + "-" + b.e + " " + b.h + ":" + b.i + ":" + b.s;
	},
	groupShowRelate: function() {
		var d = $("#JS_goods_group_left"),
		k = $("#JS_goods_group_right"),
		g = $("#JS_goods_order_similar"),
		l = $("#JS_similar_order"),
		j = $("#JS_goods_rel_cat"),
		c = $("#JS_rel_cat"),
		e = $("#JS_goods_order_similar_right");
		var b = GD.currentJoinGoods ? GD.currentJoinGoods.id: GD.firstMainGoods ? GD.firstMainGoods.id: GD.firstGoodsId;
		if (b && GL[b]) {
			var f = GL[b];
			l.on("click", "a.JS_similar_ga",
			function() {
				window._gaq && window._gaq.push(["_trackEvent", "goodsPopular", f.attr.pinyin + "_" + f.id, this.href]);
			});
		}
		if (e.length) {
			c.height(194);
			j.removeClass("none");
			return false;
		}
		if (d && k && j && c) {
			var a = k.height();
			if (a >= 300) {
				c.height(287);
				GF.goodsOrderSimilarHandle();
				g.removeClass("none");
				j.removeClass("none");
				return false;
			} else {
				var i = a - 55 - 162 - 10;
				l.height(80);
				i += 26;
				c.height(i);
				g.removeClass("none");
				j.removeClass("none");
			}
		}
	},
	goodsOrderSimilarHandle: function() {
		var c = $("#JS_similar_order"),
		b = c.find("li"),
		a = [],
		d = function(f) {
			var e = b.index(this);
			b.removeClass("current").eq(e).addClass("current");
		};
		b.mouseenter(d);
		b.eq(0).addClass("current");
	},
	parseExprData: function(p, d) {
		var g = [],
		k = p.length,
		f = 0,
		h = GD.selectCityId || $.cookie("region_id"),
		b = exprListKeyCityId[h].pinyin,
		l = $("#JS_Tab_nav_expr"),
		a = $("#JS_Tab_body_expr"),
		n = $("#JS_count_expr");
		n.html("(" + k + ")");
		g.push('<div class="tab_title"><span class="icon"></span><h2>体验馆</h2></div>');
		if (k == 1) {
			var o = p[0];
			g.push('<div class="table_body only clearfix"><div class="img Left"><a href="/');
			g.push(b);
			g.push("/visit-");
			g.push(o.expr_id);
			g.push('.html" target="_blank"><img src="#');
			g.push(o.expr_img);
			g.push('" width="216" height="136" /></a></div><div class="list Left"><h3><a href="/');
			g.push(b);
			g.push("/visit-");
			g.push(o.expr_id);
			g.push('.html" target="_blank">');
			g.push(o.expr_name);
			g.push('</a></h3><div class="info">营业时间：');
			if (o.open_detail) {
				g.push('<span class="red">');
				g.push(o.open_detail);
				g.push("</span>");
			} else {
				g.push(o.sale_time);
			}
			g.push("</div><div class=\"info\"  onmouseover=\"$('#JS_g_expr_map_0').addClass('current')\" onmouseout=\"$('#JS_g_expr_map_0').removeClass('current')\">展馆地址：<a href=\"/");
			g.push(b);
			g.push('/area.html" target="_blank" title="');
			g.push(o.expr_name);
			g.push('地址">');
			g.push(o.addr);
			g.push('</a></div><div id="JS_g_expr_map_0" class="expr_map"><img src="#');
			g.push(o.map_img);
			g.push('" alt="');
			g.push(o.expr_name);
			g.push('" /></div><div class="info">联系电话：');
			g.push(o.phone);
			g.push('</div><div class="info"><a class="goods2_send_sms" href="javascript:;" onclick="$.sendSms(\'');
			g.push(o.expr_id);
			g.push('\',{click:\'商品详情页\'});return false;">免费发送到手机</a><a class="goods2_visit_expr" href="/');
			g.push(b);
			g.push("/goods.html?act=goods&region_id=");
			g.push(h);
			g.push("&eid=");
			g.push(o.expr_id);
			g.push('" target="_blank">参观本馆展品</a></div></div><div class="score Right"><div class="precent">');
			g.push(o.percent);
			g.push('</div><a class="visit" target="我要点评" href="/');
			g.push(b);
			g.push("/score-");
			g.push(o.expr_id);
			g.push('.html"></a></div></div>');
		} else {
			g.push('<table class="table_body"><tr>');
			for (; f < k; f++) {
				var o = p[f];
				g.push('<td class="list first');
				if (f > 1) {
					g.push(" border_top");
				}
				g.push('"><h3><a href="/');
				g.push(b);
				g.push("/visit-");
				g.push(o.expr_id);
				g.push('.html" target="_blank">');
				g.push(o.expr_name);
				g.push('</a></h3><div class="info">营业时间：');
				if (o.open_detail) {
					g.push('<span class="red">');
					g.push(o.open_detail);
					g.push("</span>");
				} else {
					g.push(o.sale_time);
				}
				g.push('</div><div class="info" onmouseover="$(\'#JS_g_expr_map_');
				g.push(f);
				g.push("').addClass('current')\" onmouseout=\"$('#JS_g_expr_map_");
				g.push(f);
				g.push("').removeClass('current')\">展馆地址：<a href=\"/");
				g.push(b);
				g.push('/area.html" target="_blank" title="');
				g.push(o.expr_name);
				g.push('地址">');
				g.push(o.addr);
				g.push('</a></div><div id="JS_g_expr_map_');
				g.push(f);
				g.push('" class="expr_map"><img src="#');
				g.push(o.map_img);
				g.push('" alt="');
				g.push(o.expr_name);
				g.push('" /></div><div class="info">联系电话：');
				g.push(o.phone);
				g.push('</div><div class="info"><a href="javascript:;" class="goods2_send_sms" onclick="$.sendSms(\'');
				g.push(o.expr_id);
				g.push('\',{click:\'商品详情页\'})">免费发送到手机</a><a class="goods2_visit_expr" href="/');
				g.push(b);
				g.push("/goods.html?act=goods&region_id=");
				g.push(h);
				g.push("&eid=");
				g.push(o.expr_id);
				g.push('" target="_blank">参观本馆展品</a></div></td>');
				if (f == k - 1 && f % 2 == 0 && d) {
					g.push('<td class="list all border_top"><h3 class="red">全国体验馆</h3><div class="clearfix"><a href="#" target="_blank" title="查看全国体验馆分布" class="imgmap Left"><img src="/themes/meilele/images/map.png" width="130" height="93" alt="" /></a><ul class="Left">');
					for (var e = 0,
					c = d.length,
					c = c > 5 ? 5 : c; e < c; e++) {
						var m = d[e];
						g.push('<li><a href="/topic/');
						g.push(m.url);
						g.push('.html" title="');
						g.push(m.title);
						g.push('" target="_blank">');
						g.push(m.title);
						g.push("</a></li>");
					}
					g.push('<li class="last"><a href="/expr.html" target="_blank" title="查看全国体验馆分布" class="orange">查看全国体验馆分布&raquo;</a></li></ul></div></td>');
				}
				if (f > 0 && f != k - 1 && f % 2 == 1) {
					g.push("</tr><tr>");
				}
			}
			g.push("</tr></table>");
		}
		if (l[0] && k > 0) {
			l[0].style.display = "";
		}
		if (a) {
			a.html(g.join(""));
		}
	},
	parseZixunHtml: function(c) {
		var b = [],
		a = 0;
		b.push('<div class="tab_title"><span class="icon"></span><h2>商品咨询</h2></div><div class="tab_body">购买商品之前有任何疑问，请向美乐乐咨询。<a class="zixun_icon" href="javascript:;" onclick="GF.zixun();return false;">我要咨询</a>');
		if (c.ask_list) {
			var d = c.ask_list.length;
			b.push('</div><div class="tab_body">');
			for (; a < d; a++) {
				var e = c.ask_list[a];
				b.push('<div class="list');
				if (a % 2 == 1) {
					b.push(" list_2");
				}
				b.push('"><div class="in_title r gray">');
				if (e.user_name) {
					b.push("网友：");
					if (e.zx_user_url && e.user_name) {
						b.push('<a class="gray" target="_blank" href="');
						b.push(e.zx_user_url);
						b.push('">');
						b.push(e.user_name);
						b.push("</a>");
					}
				} else {
					b.push("匿名网友");
				}
				b.push("&ensp;|&ensp;");
				b.push(e.add_time);
				b.push('</div><div class="content clearfix"><span class="icon Left"></span><p class="Right">');
				b.push(e.content);
				b.push("</p></div>");
				if (e.re_content) {
					b.push('<div class="content re_content clearfix"><span class="icon Left"></span><p class="Right"><strong class="black"><a href="http://zx.meilele.com/user/1665545/" target="_blank">美美</a>回复</strong>：');
					b.push(e.re_content);
					b.push("</p></div>");
				}
				b.push("</div>");
			}
			b = b.concat(GF.parseZixunPageHtml(c));
		}
		b.push("</div>");
		return b.join("");
	},
	parseZixunPageHtml: function(e) {
		var d = [];
		if (e) {
			d.push('<div class="mt20 r page">');
			if (e.current > 1) {
				d.push('<a href="javascript:;" onclick="GF.getZixun(');
				d.push(e.previous_page);
				d.push(');return false;"><span class="arrow"><span class="aleft">◆</span></span>上一页</a>');
			}
			if (e.current > 5) {
				d.push('<a href="javascript:;" class="bold" onClick="GF.getZixun(1);return false;">1</a>...');
			} else {
				if (e.current > 4) {
					d.push('<a href="javascript:;" class="bold" onClick="GF.getZixun(1);return false;">1</a>');
				}
			}
			for (var c = 0,
			a = e.page_numbers.length; c < a; c++) {
				var b = e.page_numbers[c];
				if (b == e.current) {
					d.push("<strong>");
					d.push(b);
					d.push("</strong>");
				} else {
					if (b + 3 >= e.current && b - 3 <= e.current) {
						d.push('<a href="javascript:;" class="bold" onClick="GF.getZixun(');
						d.push(b);
						d.push(');return false;">');
						d.push(b);
						d.push("</a>");
					}
				}
			}
			if (e.current + 4 < e.totalpage) {
				d.push('...<a href="javascript:;" class="bold" onClick="GF.getZixun(');
				d.push(e.totalpage);
				d.push(');return false;">');
				d.push(e.totalpage);
				d.push("</a>");
			} else {
				if (e.current + 4 == e.totalpage) {
					d.push('<a href="javascript:;" class="bold" onClick="GF.getZixun(');
					d.push(e.totalpage);
					d.push(');return false;">');
					d.push(e.totalpage);
					d.push("</a>");
				}
			}
			if (e.current < e.totalpage) {
				d.push('<a href="javascript:;" onclick="GF.getZixun(');
				d.push(e.next_page);
				d.push(');return false;">下一页<span class="arrow"><span class="aright">◆</span></span></a>');
			}
			d.push('&ensp;<em>到第 </em><input class="to_page" value="');
			d.push(e.current);
			d.push('" id="JS_zixun_page_input" /><em> 页</em><a class="current" href="javascript:;" onclick="GF.getZixun(false);return false;">确定</a></div>');
		}
		return d;
	},
	insertMaiguo: function() {
		var g = $("#JS_extra_change"),
		b = $("#JS_maiguo_textarea");
		if (!window.LOAD) {
			var d = g.find("li"),
			c = b.val(),
			a = d.length;
			if (c) {
				var f = $('<div id="JS_extra_bo_body" class="maiguo"></div>'),
				e = $('<li id="JS_extra_bo">大家还买了</li>');
				a > 0 ? f.addClass("none") : e.addClass("current");
				f.html(c);
				b.parent().append(f);
				g.append(e);
			}
		}
	},
	sendSmsExprAddress: function() {
		var e = $(this);
		var g = e.attr("data-region_id");
		var c = e.attr("data-type");
		var i = g || GD.selectCityId,
		b = exprListKeyCityId[i],
		f,
		d,
		h = [],
		a;
		if (b && window.mchat && window.mchat.showSmsList) {
			if (b.list) {
				f = b.list;
				for (d in f) {
					h.push({
						exprId: f[d].expr_id,
						exprName: f[d].expr_name
					});
				}
				a = {
					cityName: b.city_name,
					exprList: h
				};
			}
			$.sendSms(false, {
				click: c || "产品详情页体验馆速递",
				exprInfo: a
			});
			return false;
		}
	},
	imgTagShow: function() {
		var e = $(".show_default_0");
		var d = [];
		var c = $(window);
		var b = c.height();
		var a, f;
		c.on("scroll.imgTag",
		function() {
			clearTimeout(GD.scrollTime);
			GD.scrollTime = setTimeout(function() {
				a = c.scrollTop();
				e.each(function(k, m) {
					if (e.length <= k) {
						return;
					}
					var g = e.eq(k);
					var j = g.offset().top;
					var l = g.height();
					if (j >= a && ((l < b && j - a + l < b) || (l > b && j + l / 2 > a + b))) {
						g.css({
							opacity: 0,
							visibility: "visible"
						}).animate({
							opacity: 1
						},
						5000);
						e = e.not(m);
						e.length == 0 && c.off("scroll.imgTag");
					}
				});
			},
			300);
		});
		c.trigger("scroll.imgTag");
		$(".img_tag_box_m").mouseenter(function() {
			$(this).find(".hover_show").show();
		}).mouseleave(function() {
			$(this).find(".hover_show").hide();
		});
	}
};
function goodsInit() {
	var a = GD.currentJoinGoods || GD.firstMainGoods;
	if (a) {
		a.attr.goods_attribute == 6 ? a.setCopyGoodsCurrent(true) : a.setJoinGoodsCurrent(true);
		if (a.attr.price_type.show_price < 500) {
			mchat.not_show = true;
		}
	}
	$(window).load(GF.lazyImg);
	GF.groupShowRelate();
	GF.toggleTab();
	GF.insertMaiguo();
	GF.peitaoScroll();
	GF.floatNavs();
	var c = $("#JS_view_current_big_img");
	c.click(function() {
		GD.firstMainGoods.viewImg();
	});
	c = null;
	var b = $("#JS_collect_2");
	b.click(function() {
		GD.currentJoinGoods.collect();
	});
	b = null;
	if (typeof(specailAreaString) == "string") {
		specailArea = specailAreaString.split(",");
	}
	GF.getGoodsDetail();
	$(document).on("click", ".JS_send_expr_adress", GF.sendSmsExprAddress);
	GF.imgTagShow();
}
function _GOODS_STATIC_REGION_INFO(c) {
	if (c && c.html_content) {
		GD.local = c.html_content;
		var g = GD.currentJoinGoods ? GD.currentJoinGoods.id: GD.firstMainGoods ? GD.firstMainGoods.id: 0,
		d = GD.local;
		if (g) {
			var f = $("#JS_peisong_address_nav_" + g),
			a = $("#JS_anzhuang_text_sheng"),
			b = $("#JS_anzhuang_text_shi"),
			e = $("#JS_anzhuang_shi");
			if (f.length) {
				GD.selectCityId = d.region_id;
				GD.selectCityName = d.cname;
				GL[g].selectProvince(d.pid, d.pname, true);
			}
			a.html(d.pname);
			b.html(d.cname);
			e.removeClass("none");
		}
	}
}
function _COMMON_UNIX_TIME(a) {
	if (a && a.html_content) {
		GD.unixTime = a.html_content;
		var b = GD.currentJoinGoods ? GD.currentJoinGoods.id: GD.firstMainGoods ? GD.firstMainGoods.id: GD.firstGoodsId;
		if (b && GL[b]) {
			GL[b].setCurrentGoodsActiveTime();
		}
	}
}
function _Collect_Goods(b) {
	if (b && b.html_content == 1) {
		var d = GD.currentJoinGoods ? GD.currentJoinGoods.id: GD.firstMainGoods ? GD.firstMainGoods.id: GD.firstGoodsId;
		if (d && GL[d]) {
			GL[d].collected = 1;
			var c = $("#JS_collect_2");
			var a = $("#JS_main_goods_collect_" + d);
			c.addClass("collected");
			a.addClass("collected");
			c = a = null;
		}
	}
}
function _GoodsGift_Info(a) {
	if (a && a.html_content && a.html_content.length > 0) {
		var b = GD.currentJoinGoods ? GD.currentJoinGoods.id: GD.firstMainGoods ? GD.firstMainGoods.id: GD.firstGoodsId;
		if (b && GL[b]) {
			GL[b].showGiftInfo(a.html_content);
		}
	}
}
function inArray(d, a) {
	var b = 0;
	if (d.indexOf) {
		b = d.indexOf(a);
		if (b == -1) {
			b = d.indexOf(a + "");
		}
		return ! (b == -1);
	} else {
		var c = d.length;
		for (; b < c && d[b] != a; b++) {}
		return ! (b == c);
	}
}
/*GERMANY:2013-11-21 19:47:41*/
