$.searchKey=function(b,a){return new $.searchKey.prototype.init(b,a);};$.searchKey.prototype={constructor:$.searchKey,init:function(b,a){var c=this;this.inputId=b;
this.inputDom=$("#"+b);this.showDom=$("#"+a);this.inputValue="";this.inputDom.click(function(d){d.stopPropagation();}).blur(function(){clearInterval(c.timer);
}).focus(function(){c.showKeyList();c.timer=setInterval(function(){c.inputValueCheck();},50);}).keyup(function(e){if(e.which==38||e.which==40){c.selectKeyInList(e.which);
c.keyMove=true;e.preventDefault();}else{if(e.which==13){if(c.showList){var d=c.showList.eq(c.showIndex);if(d.parent().is(".catelist")&&d.attr("href")){window.location.href=d.attr("href");
e.preventDefault();}}}else{c.keyMove=false;}}});this.showDom.parent().mouseenter(function(){clearTimeout(c.hideTimer);}).mouseleave(function(){c.hideShowList();
});this.showDom.mouseover(function(d){var e=d.target;if(e.nodeName=="A"&&c.showList){c.showList.eq(c.showIndex).removeClass("current");c.showIndex=c.showList.index(e);
c.showList.eq(c.showIndex).addClass("current");}});$(document).click(function(){c.hideShowList(true);});this.inputDom.focus();c.hideShowList(true);},inputValueCheck:function(){var a=this.inputDom.val();
if(!this.keyMove&&a&&a!=this.inputValue){this.inputValue=a;this.getKeyList(a);}},getKeyList:function(a){clearTimeout(this.hideTimer);this.ajaxGetting&&this.ajaxGetting.abort();
this.ajaxGetting=null;a=a||this.inputDom.val();var b=this;if(!a){return false;}this.ajaxGetting=$.ajax({url:"/suggestion/?q="+encodeURIComponent(a),dataType:"json",success:function(c){clearTimeout(b.hideTimer);
b.ajaxGetting=null;b.drawKeyList(c);},error:function(){b.hideShowList(true);}});},drawKeyList:function(d){if(d&&(d.catogyList||d.keywordList)){var c=d.catogyList,g=d.keywordList,f=c?c.length:0,k=g?g.length:0,b=j=0,e=html="",a;
for(;b<f;b++){a=c[b];if(a.isCategory){html+='<a href="'+a.url+'">在<strong class="red">'+a.name+"</strong>分类中搜索</a>";}else{e+='<a href="'+a.url+'">'+a.name+"</a>";
}}if(html){e+='<div class="catelist">'+html+"</div>";}for(;j<k;j++){a=g[j];e+='<a href="'+a.url+'">'+a.name+"</a>";}if(e){this.showDom.html(e).show();this.showList=this.showDom.find("a");
this.showIndex=-1;}}},showKeyList:function(){this.showIndex>-1&&this.showList.eq(this.showIndex).removeClass("current");this.showDom.show();this.showIndex=-1;
},hideShowList:function(a){var b=this;clearTimeout(this.hideTimer);if(a){this.showDom.hide();}else{this.hideTimer=setTimeout(function(){b.showDom.hide();
},1000);}},selectKeyInList:function(e){if(!this.showList){return;}var b=this.showList,a=this.showIndex,d=b.length-1,c,f="";if(a>-1){b.eq(a).removeClass("current");
}if(e>39||e=="down"){a++;}else{a--;}a=a>d?0:a<0?d:a;this.showIndex=a;c=b.eq(a);if(!c.addClass("current").parent().is(".catelist")){f=c.text();}else{f=b.eq(0).text();
}f&&this.inputDom.val(f);}};$.searchKey.prototype.init.prototype=$.searchKey.prototype;
/*GERMANY:2013-09-15 16:01:40*/